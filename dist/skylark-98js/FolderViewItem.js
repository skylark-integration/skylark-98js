/**
 * skylark-98js - A version of 98js.js that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-98js/
 * @license MIT
 */
define(["skylark-jquery","./win98","./helpers"],function(e,t,s){"use strict";return function(t){var i,n=e("<div class='desktop-icon' draggable='true' tabindex=-1/>"),a=e("<div class='icon-wrapper'/>").appendTo(n),o=e("<div class='selection-effect'/>").appendTo(a),r=e("<div class='title'/>").text(t.title);let c;n.append(a,r),n.on("dblclick",e=>{e.ctrlKey||e.metaKey||e.shiftKey||e.altKey||(t.open(),clearTimeout(c))}),r.on("click",()=>{n[0]._was_selected_at_pointerdown&&(c=setTimeout(()=>{n.hasClass("selected")&&this.start_rename()},500))}),t.shortcut&&n.addClass("shortcut"),n[0].dataset.filePath=t.file_path,this.element=n[0],this.icons=t.icons,this.iconSize=t.iconSize||s.DESKTOP_ICON_SIZE,this.file_path=t.file_path,this.is_system_folder=t.is_system_folder,this._update_icon=(()=>{if(this.icons){const t=i,s=this.icons[this.iconSize];(i=e("<img class='icon'/>")).attr({draggable:!1,src:s,width:this.iconSize,height:this.iconSize}),o[0].style.setProperty("--icon-image",`url("${s}")`),t?t.replaceWith(i):a.prepend(i)}else i&&i.remove(),i=null,o[0].style.setProperty("--icon-image","none");a[0].style.setProperty("--icon-size",this.iconSize+"px"),a[0].style.setProperty("--shortcut-icon",`url("${s.getIconPath("shortcut",this.iconSize)}")`)}),this.setIcons=(e=>{this.icons=e,this._update_icon()}),this.setIconSize=(e=>{this.iconSize!==e&&(this.iconSize=e,this._update_icon())}),this._update_icon(),this.start_rename=(()=>{if(!t.rename)return;if(n.hasClass("renaming"))return;n.addClass("renaming"),n.attr("draggable",!1);const s=r.text(),i=e("<input type='text'/>");i.val(s),i.on("keydown",e=>{"Enter"===e.key?(n.focus(),e.preventDefault()):"Escape"===e.key&&(i.val(s),n.focus(),e.preventDefault())}),i.on("blur",()=>{const e=i.val();""!==e.trim()?(i.remove(),r.text(e),n.removeClass("renaming"),n.attr("draggable",!0),e!==s&&t.rename(e).catch(e=>{r.text(s),alert("Failed to rename:\n\n"+e)})):showMessageBox({title:"Rename",message:"You must type a filename.",iconID:"error"}).then(()=>{i.focus()})}),r.empty().append(i),i[0].focus(),i[0].select()})}});
//# sourceMappingURL=sourcemaps/FolderViewItem.js.map
