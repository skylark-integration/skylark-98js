/**
 * skylark-98js - A version of 98js.js that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-integration/skylark-98js/
 * @license MIT
 */
define(["skylark-jquery","./win98","./FolderView","./programs"],function(e,t,o,r){"use strict";var a=e(".desktop");a.css("touch-action","none");var n=new o("/desktop/",{asDesktop:!0,openFileOrFolder:e=>{r.systemExecuteFile(e)}});e(n.element).appendTo(a);try{var l=localStorage.getItem("wallpaper-data-url"),i=localStorage.getItem("wallpaper-repeat"),s=localStorage.getItem("desktop-theme");l&&fetch(l).then(e=>e.blob()).then(e=>{!function(e,t,o){const r=URL.createObjectURL(e);if(a.css({backgroundImage:`url(${r})`,backgroundRepeat:t,backgroundPosition:"center",backgroundSize:"auto"}),o){var n=new FileReader;window.fr=n,n.onload=(()=>{localStorage.setItem("wallpaper-data-url",n.result),localStorage.setItem("wallpaper-repeat",t)}),n.onerror=(()=>{console.error("Error reading file (for setting wallpaper)",e)}),n.readAsDataURL(e)}}(e,i,!1)}),s&&p(s)}catch(e){console.error(e)}function c(e){var t=new FileReader;t.onload=(()=>{p(t.result)}),t.readAsText(e)}function p(e){var t=parseThemeFileString(e);!function(e,t=document.documentElement){applyCSSProperties(e,{element:t,recurseIntoIframes:!0})}(t),window.themeCSSProperties=t}return e("html").on("dragover",function(e){e.preventDefault(),e.stopPropagation()}),e("html").on("dragleave",function(e){e.preventDefault(),e.stopPropagation()}),e("html").on("drop",function(e){e.preventDefault(),e.stopPropagation();var t=[...e.originalEvent.dataTransfer.files];for(var o of t)o.name.match(/\.theme(pack)?$/i)&&c(o)}),e(window).on("scroll focusin",()=>{window.scrollTo(0,0)}),r.initDesktopFolderView(n),t.$desktop=a});
//# sourceMappingURL=sourcemaps/$desktop.js.map
