{"version":3,"sources":["$start-menu.js"],"names":["define","$","win98js","$Window","$start_menu","hide","close_start_menu","$start_button","removeClass","attr","toggle_start_menu","is","addClass","slideDown","css","zIndex","Z_INDEX","on","e","target","closest","length","window","which"],"mappings":";;;;;;;AAAAA,QACC,iBACA,UACA,oBACC,SAASC,EAAEC,EAAQC,GASpB,IAAIC,EAAcH,EAAE,eACpBG,EAAYC,OAEZ,IAMIC,EAAmB,WACtBC,EAAcC,YAAY,YAC1BJ,EAAYK,KAAK,SAAU,UAC3BL,EAAYC,QAETK,EAAoB,WACnBN,EAAYO,GAAG,YAXnBJ,EAAcK,SAAS,YACvBR,EAAYK,KAAK,SAAU,MAC3BL,EAAYS,UAAU,KACtBT,EAAYU,KAAMC,SAAUZ,EAAQa,QAAU,QAW7CV,KAIEC,EAAgBN,EAAE,iBAuBtB,OAtBAM,EAAcU,GAAG,cAAe,WAC/BP,MAGDT,EAAE,QAAQgB,GAAG,cAAe,SAAUC,GAC4B,IAA7DjB,EAAEiB,EAAEC,QAAQC,QAAQ,8BAA8BC,QACrDf,MAUFL,EAAEqB,QAAQL,GAAG,UAAW,SAAUC,GACjB,KAAZA,EAAEK,OACLjB,MAIKF","file":"../$start-menu.js","sourcesContent":["define([\n\t\"skylark-jquery\",\n\t\"./win98\",\n\t\"./os-gui/$Window\"\n],function($,win98js,$Window){\n\t// TODO: start menu\n\n\t/*\n\t// if running from file: protocol, try to sniff the username >:)\n\tvar username_match = location.href.match(/\\/(Users|home)\\/(\\w+)\\//);\n\tvar username = username_match && username_match[1] || \"Admin\";\n\t*/\n\n\tvar $start_menu = $(\".start-menu\");\n\t$start_menu.hide();\n\t// TODO: legitimate contents or whatever\n\tvar open_start_menu = function () {\n\t\t$start_button.addClass(\"selected\");\n\t\t$start_menu.attr(\"hidden\", null);\n\t\t$start_menu.slideDown(100); // DOWN AS IN UP (stupid jQuery)\n\t\t$start_menu.css({ zIndex: ++$Window.Z_INDEX + 5001 });\n\t};\n\tvar close_start_menu = function () {\n\t\t$start_button.removeClass(\"selected\");\n\t\t$start_menu.attr(\"hidden\", \"hidden\");\n\t\t$start_menu.hide();\n\t};\n\tvar toggle_start_menu = function () {\n\t\tif ($start_menu.is(\":hidden\")) {\n\t\t\topen_start_menu();\n\t\t} else {\n\t\t\tclose_start_menu();\n\t\t}\n\t};\n\n\tvar $start_button = $(\".start-button\");\n\t$start_button.on(\"pointerdown\", function () {\n\t\ttoggle_start_menu();\n\t});\n\n\t$(\"body\").on(\"pointerdown\", function (e) {\n\t\tif ($(e.target).closest(\".start-menu, .start-button\").length === 0) {\n\t\t\tclose_start_menu();\n\t\t}\n\t});\n\t// Note: A lot of the time it's good to use focusout (in jQuery, or else blur with useCapture?[1]) as opposed to \n\t// That might be the case here as well, but maybe not since programs opening might grab focus and that probably shouldn't close the start menu\n\t// Although at the operating system level it would probably prevent focus switching in the first place, so maybe we could do that\n\t// The point being this is an operating system control and so it may warrant special handling,\n\t// but generally I'd recommend making a control focusable and detecting loss of focus as in this answer:\n\t// [1]: https://stackoverflow.com/a/38317768/2624876\n\n\t$(window).on(\"keydown\", function (e) {\n\t\tif (e.which === 27) { // Esc to close\n\t\t\tclose_start_menu();\n\t\t}\n\t});\n\n\treturn $start_menu;\n});"]}