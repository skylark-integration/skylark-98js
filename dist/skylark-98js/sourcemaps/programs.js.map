{"version":3,"sources":["programs.js"],"names":["define","$","win98js","FilesystemSetup","helpers","FolderViewItem","iframeWindows","Task","VisualizerOverlay","$Window","make_iframe_window","show_help","options","$help_window","title","icons","iconsAtTwoSizes","resizable","addClass","ignore_one_load","back_length","forward_length","$main","E","$toolbar","add_toolbar_button","name","sprite_n","action_fn","enabled_fn","$button","append","text","appendTo","on","css","backgroundPosition","update_enabled","disabled","measure_sidebar_width","$contents","outerWidth","parseFloat","getComputedStyle","getPropertyValue","$resizer","$hide_button","toggling_width","hide","$show_button","show","width","offset","left","$iframe","contentWindow","history","back","forward","iframe","src","attr","enhance_iframe","$window","location","href","triggerHandler","$content","height","backgroundColor","border","margin","center","position","cursor","boxSizing","background","borderLeft","boxShadow","top","bottom","zIndex","e","pointermove","pointerup","getPos","Math","min","max","clientX","$G","marginRight","off","flexBasis","parse_object_params","$object","object","param","children","get","value","$last_expanded","make_$item","$item","find","removeClass","$li","parent","is","not","toggleClass","$default_item_li","contentsFile","hhc","parseHTML","filter","forEach","li","renderItemFromContents","source_li","$folder_items_ul","length","$folder_li","Name","$item_li","root","Local","task","Notepad","file_path","win_title","file_name_from_path","$win","outerHeight","Paint","minOuterWidth","minOuterHeight","waitUntil","test","interval","callback","setTimeout","systemHooks","readBlobFromHandle","Promise","resolve","reject","withFilesystem","BrowserFS","BFSRequire","readFile","err","buffer","byte_array","Uint8Array","blob","Blob","file_name","replace","file","File","writeBlobToHandle","async","arrayBuffer","fs","Buffer","from","writeFile","setWallpaperCentered","canvas","toBlob","setDesktopWallpaper","setWallpaperTiled","Object","assign","focus","then","open_from_file","error","show_error_message","old_update_title","update_title","document","Minesweeper","innerWidth","innerHeight","SoundRecorder","minInnerWidth","minInnerHeight","Solitaire","showScreensaver","iframeSrc","$backing","Z_INDEX","pointerEvents","cleanUp","remove","prevent","event","preventDefault","window","removeEventListener","keydownHandler","includes","key","stopPropagation","startMouseX","startMouseY","undefined","pageX","pageY","hypot","addEventListener","Pipes","encodeURIComponent","JSON","stringify","hideUI","FlowerBox","CommandPrompt","[object Object]","rect","x_axis","y_axis","inner_rect","x","y","$titlebar","new_inner_rect","floor","new_rect","Calculator","Pinball","override_alert","$splash","Explorer","address","acceptsFilePaths","load_winamp_bundle_if_not_loaded","includeButterchurn","getScript","isButterchurnSupported","createElement","gl","getContext","webGL2Supported","audioApiSupported","AudioContext","webkitAudioContext","webamp","$webamp","winamp_task","winamp_interface","winamp_loading","openWinamp","filePathToBlob","filePathToTrack","url","URL","createObjectURL","defaultName","whenLoaded","unminimize","match","setSkinFromUrl","alert","track","setTracksToPlay","webamp_options","initialTracks","metaData","artist","duration","enableHotkeys","handleTrackDropEvent","all","dragging_file_paths","map","__butterchurnOptions","importButterchurn","butterchurn","getPresets","presets","butterchurnPresets","keys","butterchurnPresetObject","butterchurnOpen","__initialWindowLayout","main","equalizer","playlist","size","milkdrop","Webamp","visual_container","classList","add","style","right","body","appendChild","renderWhenReady","console","log","$eventTarget","makeSimpleListenable","fn","raf_id","onFocus","onBlur","onClosed","getIconAtSize","target_icon_size","img","getIconPath","bringToFront","element","hasClass","className","blur","minimize","close","dispose","getTitle","taskTitle","$cell","getMediaStatus","setMinimizeTarget","event_name","onTrackDidChange","warn","mustHaveMethods","windowInterfaceMethods","onClose","cancelAnimationFrame","visualizerOverlay","fadeOutAndCleanUp","onMinimize","activeElement","closest","mirror","stretch","animate","toArray","windowEl","hasOverlayCanvas","makeOverlayCanvas","fadeIn","fadeOut","requestAnimationFrame","openURLFile","content","openThemeFile","loadThemeFromText","localStorage","setItem","file_extension_associations","","ahk","ai","bat","check_cache","cmake","cmd","conf","cpp","d","editorconfig","filters","gitattributes","gitignore","gitrepo","h","hhk","html","ini","js","json","make","marks","md","prettierignore","properties","rc","rsp","sh","ts","txt","vcxproj","webmanifest","xml","yml","bmp","cur","eps","gif","icns","ico","jpeg","jpg","kra","pbm","pdf","pdn","pgm","png","pnm","ppm","ps","psd","svg","tga","tif","tiff","webp","xbm","xcf","xcfbz2","xcfgz","xpm","wsz","zip","wav","mp3","ogg","wma","m4a","aac","flac","mka","mpc","mp+","m3u","pls","htm","theme","themepack","systemExecuteFile","stat","stats","isDirectory","file_extension","file_extension_from_path","program","toLowerCase","iconID","16","32","initDesktopFolderView","folder_view","add_icon_not_via_filesystem","add_item","DESKTOP_ICON_SIZE","open","is_system_folder","shortcut","arrange_icons"],"mappings":";;;;;;;AAAAA,QACC,iBACA,UACA,qBACA,YACA,mBACA,mBACA,SACA,uBACA,oBACC,SAASC,EAAEC,EAAQC,EAAgBC,EAAQC,EAAeC,EAAcC,EAAKC,EAAmBC,GACjG,IAAIC,EAAqBJ,EAAcI,mBAEvC,SAASC,EAAUC,GAClB,MAAMC,EAAeJ,GACpBK,MAAOF,EAAQE,OAAS,cACxBC,MAAOC,EAAgB,OACvBC,WAAW,IAEZJ,EAAaK,SAAS,eAEtB,IAAIC,GAAkB,EAClBC,EAAc,EACdC,EAAiB,EAErB,MAAMC,EAAQrB,EAAEsB,EAAE,QAAQL,SAAS,QAC7BM,EAAWvB,EAAEsB,EAAE,QAAQL,SAAS,WAChCO,EAAqB,CAACC,EAAMC,EAAUC,EAAWC,KACtD,MAAMC,EAAU7B,EAAE,gCAChB8B,OAAO9B,EAAE,UAAU+B,KAAKN,IACxBO,SAAST,GACTU,GAAG,QAAS,KACZN,MAEF3B,EAAE,uBACAgC,SAASH,GACTK,KACAC,sBAAmC,IAAXT,YAE1B,MAAMU,EAAiB,KACtBP,EAAQ,GAAGQ,SAAWT,IAAeA,KAKtC,OAHAQ,IACAxB,EAAaqB,GAAG,QAAS,IAAKG,GAC9BxB,EAAaqB,GAAG,iBAAkBG,GAC3BP,GAEFS,EAAwB,IAC7BC,EAAUC,aACVC,WAAWC,iBAAiBH,EAAU,IAAII,iBAAiB,gBAC3DF,WAAWC,iBAAiBH,EAAU,IAAII,iBAAiB,iBAC3DC,EAASJ,aACJK,EAAerB,EAAmB,OAAQ,EAAG,KAClD,MAAMsB,EAAiBR,IACvBC,EAAUQ,OACVH,EAASG,OACTF,EAAaE,OACbC,EAAaC,OACbrC,EAAasC,MAAMtC,EAAasC,QAAUJ,GAC1ClC,EAAasB,IAAI,OAAQtB,EAAauC,SAASC,KAAON,KAEjDE,EAAexB,EAAmB,OAAQ,EAAG,KAClDe,EAAUU,OACVL,EAASK,OACTD,EAAaD,OACbF,EAAaI,OACb,MAAMH,EAAiBR,IACvB1B,EAAasC,MAAMtC,EAAasC,QAAUJ,GAC1ClC,EAAasB,IAAI,OAAQtB,EAAauC,SAASC,KAAON,GAGlDlC,EAAauC,SAASC,KAAO,IAChCxC,EAAasC,MAAMtC,EAAasC,QAAUtC,EAAauC,SAASC,MAChExC,EAAasB,IAAI,OAAQ,MAExBa,OACHvB,EAAmB,OAAQ,EAAG,KAC7B6B,EAAQ,GAAGC,cAAcC,QAAQC,OACjCtC,GAAkB,EAClBC,GAAe,EACfC,GAAkB,GAChB,IAAMD,EAAc,GACvBK,EAAmB,UAAW,EAAG,KAChC6B,EAAQ,GAAGC,cAAcC,QAAQE,UACjCvC,GAAkB,EAClBE,GAAkB,EAClBD,GAAe,GACb,IAAMC,EAAiB,GAC1BI,EAAmB,UAAW,EAAG,OAAW,KAAM,GAClDA,EAAmB,WAAY,EAAG,KACjCkC,EAAOC,IAAM,4BAGd,MAAMN,EAAUrD,EAAE,4GAChB4D,MAAOD,IAAK,sBACZ1C,SAAS,cACLyC,EAASL,EAAQ,GACvBQ,eAAeH,GACfA,EAAOI,QAAUlD,EACjB,MAAMgC,EAAW5C,EAAEsB,EAAE,QAAQL,SAAS,WAChCsB,EAAYvC,EAAEsB,EAAE,OAAOL,SAAS,uBAGtCoC,EAAQpB,GAAG,OAAQ,KACbf,IACJC,GAAe,EACfC,EAAiB,GAElBsC,EAAOJ,cAAcS,SAASC,KAC9B9C,GAAkB,EAClBN,EAAaqD,eAAe,oBAG7B5C,EAAMS,OAAOS,EAAWK,EAAUS,GAClCzC,EAAasD,SAASpC,OAAOP,EAAUF,GAEvCT,EAAasB,KAAMgB,MAAO,IAAKiB,OAAQ,MAEvCd,EAAQO,MAAOnC,KAAM,eACrB4B,EAAQnB,KACPkC,gBAAiB,QACjBC,OAAQ,GACRC,OAAQ,QAET/B,EAAUL,KACToC,OAAQ,QAET1D,EAAa2D,SAEblD,EAAMa,KACLsC,SAAU,aAIX5B,EAASV,KACRuC,OAAQ,YACRvB,MAHqB,EAIrBwB,UAAW,aACXC,WAAY,oBACZC,WAAY,gCACZC,UAAW,qCACXC,IAAK,EACLC,OAAQ,EACRC,OAAQ,IAETpC,EAASX,GAAG,cAAgBgD,IAC3B,IAAIC,EAAaC,EACjB,MAAMC,EAAUH,GACfI,KAAKC,IAAI1E,EAAasC,QAAU,IAAKmC,KAAKE,IAAI,GAC7CN,EAAEO,QAAU5E,EAAasD,SAASf,SAASC,OAE7CqC,GAAGxD,GAAG,cAAeiD,EAAc,CAACD,IACnCrC,EAASV,KACRsC,SAAU,WACVpB,KAAMgC,EAAOH,KAEd1C,EAAUL,KACTwD,YAxBmB,OA2BrBD,GAAGxD,GAAG,YAAakD,EAAY,CAACF,IAC/BQ,GAAGE,IAAI,cAAeT,GACtBO,GAAGE,IAAI,YAAaR,GACpBvC,EAASV,KACRsC,SAAU,GACVpB,KAAM,KAEPb,EAAUL,KACT0D,UAAWR,EAAOH,GAnCC,EAoCnBS,YAAa,UAKhB,MAAMG,EAAsBC,IAE3B,MAAMC,KACN,IAAK,MAAMC,KAASF,EAAQG,SAAS,SAASC,MAC7CH,EAAOC,EAAMvE,MAAQuE,EAAMG,MAE5B,OAAOJ,GAGR,IAAIK,EAEJ,MAAMC,EAAatE,IAClB,MAAMuE,EAAQtG,EAAEsB,EAAE,QAAQL,SAAS,QAAQc,KAAKA,GAehD,OAdAuE,EAAMrE,GAAG,YAAa,KACrBM,EAAUgE,KAAK,SAASC,YAAY,YACpCF,EAAMrF,SAAS,cAEhBqF,EAAMrE,GAAG,QAAS,KACjB,MAAMwE,EAAMH,EAAMI,SACdD,EAAIE,GAAG,aACNP,GACHA,EAAeQ,IAAIH,GAAKD,YAAY,YAErCC,EAAII,YAAY,YAChBT,EAAiBK,KAGZH,GAGFQ,EAAmB9G,EAAEsB,EAAE,OAAOL,SAAS,QAC7C6F,EAAiBhF,OAAOuE,EAAW,mBAAmBpE,GAAG,QAAS,KACjEoB,EAAQO,MAAOD,IAAK,yBAErBpB,EAAUT,OAAOgF,GA6BjB9G,EAAEkG,IAAIvF,EAAQoG,aAAcC,IAC3BhH,EAAEA,EAAEiH,UAAUD,IAAME,OAAO,MAAMjB,WAAWC,MAAMiB,QAASC,KA5B5D,SAASC,EAAuBC,EAAWC,GAC1C,MAAMxB,EAASF,EAAoB7F,EAAEsH,GAAWrB,SAAS,WACzD,GAAIjG,EAAEsH,GAAWf,KAAK,MAAMiB,OAAS,EAAG,CAEvC,MAAMC,EAAazH,EAAEsB,EAAE,OAAOL,SAAS,UACvCwG,EAAW3F,OAAOuE,EAAWN,EAAO2B,OACpCnF,EAAUT,OAAO2F,GAEjB,MAAMF,EAAmBvH,EAAEsB,EAAE,OAC7BmG,EAAW3F,OAAOyF,GAElBvH,EAAEsH,GAAWrB,SAAS,MAAMA,WAAWC,MAAMiB,QAASC,IACrDC,EAAuBD,EAAIG,SAEtB,CACN,MAAMI,EAAW3H,EAAEsB,EAAE,OAAOL,SAAS,QACrC0G,EAAS7F,OAAOuE,EAAWN,EAAO2B,MAAMzF,GAAG,QAAS,KACnDoB,EAAQO,MAAOD,OAAQhD,EAAQiH,QAAQ7B,EAAO8B,aAE3CN,EACHA,EAAiBzF,OAAO6F,GAExBpF,EAAUT,OAAO6F,IAOlBN,CAAuBD,EAAI,UAY7B,IAAIU,EAAO,IAAIxH,EAAKM,GAEpB,OADAkH,EAAKlH,aAAeA,EACbkH,EAGR,SAASC,EAAQC,GAEhB,IACIC,GADiBD,EAAYE,oBAAoBF,GAAa,YACjC,aAG7BG,EAAO1H,GACVkD,IAAK,+BAAiCqE,EAAa,SAAWA,EAAa,IAC3ElH,MAAOC,EAAgB,WACvBF,MAAOoH,EACPzF,WAAY,IACZ4F,YAAa,IACbpH,WAAW,IAEZ,OAAO,IAAIV,EAAK6H,GAIjB,SAASE,EAAML,GACd,IAAIG,EAAO1H,GACVkD,IAAK,8BACL7C,MAAOC,EAAgB,SAEvBF,MAAO,mBACP2B,WAAY,IACZ4F,YAAa,IACbE,cAAe,IACfC,eAAgB,MAGbjF,EAAgB6E,EAAK9E,QAAQ,GAAGC,cAEhCkF,EAAY,SAAUC,EAAMC,EAAUC,GACrCF,IACHE,IAEAC,WAAWJ,EAAWE,EAAUD,EAAMC,EAAUC,IAIlD,MAAME,GACLC,mBAAqBd,GACb,IAAIe,QAAQ,CAACC,EAASC,KAC5B/I,EAAgBgJ,eAAe,KACrBC,UAAUC,WAAW,MAC3BC,SAASrB,EAAW,CAACsB,EAAKC,KAC5B,GAAID,EACH,OAAOL,EAAOK,GAEf,MAAME,EAAa,IAAIC,WAAWF,GAC5BG,EAAO,IAAIC,MAAMH,IACjBI,EAAY5B,EAAU6B,QAAQ,QAAS,IACvCC,EAAO,IAAIC,MAAML,GAAOE,GAC9BZ,EAAQc,SAKZE,kBAAmBC,MAAOjC,EAAW0B,KACpC,MAAMQ,QAAoBR,EAAKQ,cAC/B,OAAO,IAAInB,QAAQ,CAACC,EAASC,KAC5B/I,EAAgBgJ,eAAe,KAC9B,MAAMiB,EAAKhB,UAAUC,WAAW,OAC1BgB,OAAEA,GAAWjB,UAAUC,WAAW,UAClCG,EAASa,EAAOC,KAAKH,GAC3BC,EAAGG,UAAUtC,EAAWuB,EAASD,IAChC,GAAIA,EACH,OAAOL,EAAOK,GAEfN,WAKJuB,qBAAuBC,IACtBA,EAAOC,OAAQf,IACdgB,oBAAoBhB,EAAM,aAAa,MAGzCiB,kBAAoBH,IACnBA,EAAOC,OAAQf,IACdgB,oBAAoBhB,EAAM,UAAU,OAoDvC,OAvCAlB,EAAU,IAAKlF,EAAcuF,YAAa,IAAK,KAG9C,IAAIjI,EAFJgK,OAAOC,OAAOvH,EAAcuF,YAAaA,GAGzCvF,EAAc5C,UAAY,MACrBE,EACHA,EAAakK,SAGdlK,EAAeF,GACdG,MAAO,aACPkG,aAAc,oCACda,KAAM,0BACJhH,cACUqB,GAAG,QAAS,KACxBrB,EAAe,SAIboH,GAGHa,EAAYC,mBAAmBd,GAAW+C,KAAKjB,IAC1CA,GACHxG,EAAc0H,eAAelB,EAAM9B,IAEjCiD,IAEH3H,EAAc4H,0CAA0ClD,IAAaiD,KAIvE,IAAIE,EAAmB7H,EAAc8H,aACrC9H,EAAc8H,aAAe,MAC5BD,IACAhD,EAAKtH,MAAMyC,EAAc+H,SAASxK,WAI7B,IAAIP,EAAK6H,GAIjB,SAASmD,IACR,IAAInD,EAAO1H,GACVkD,IAAK,kCACL7C,MAAOC,EAAgB,eACvBF,MAAO,cACP0K,WAAY,IACZC,YAAa,IACbxK,WAAW,IAEZ,OAAO,IAAIV,EAAK6H,GAGjB,SAASsD,EAAczD,GAEtB,IACIC,GADiBD,EAAYE,oBAAoBF,GAAa,SACjC,oBAE7BG,EAAO1H,GACVkD,IAAK,sCAAwCqE,EAAa,SAAWA,EAAa,IAClFlH,MAAOC,EAAgB,WACvBF,MAAOoH,EACPsD,WAAY,IACZC,YAAa,IACbE,cAAe,IACfC,eAAgB,MAEjB,OAAO,IAAIrL,EAAK6H,GAIjB,SAASyD,IACR,IAAIzD,EAAO1H,GACVkD,IAAK,mCACL7C,MAAOC,EAAgB,aACvBF,MAAO,YACP0K,WAAY,IACZC,YAAa,MAEd,OAAO,IAAIlL,EAAK6H,GAGjB,SAAS0D,EAAgBC,GACxB,MACMzI,EAAUrD,EAAE,YAAY4D,KAAK,MAAOkI,GACpCC,EAAW/L,EAAE,SACnB+L,EAAS7J,KACRsC,SAAU,QACVpB,KAAM,EACN0B,IAAK,EACL5B,MAAO,OACPiB,OAAQ,OACRa,OAAQxE,EAAQwL,QAAU,KAC1BvH,OAAQ,OACRL,gBAAiB,UAElBf,EAAQnB,KACPsC,SAAU,QACVpB,KAAM,EACN0B,IAAK,EACL5B,MAAO,OACPiB,OAAQ,OACRa,OAAQxE,EAAQwL,QAAU,KAC1B3H,OAAQ,EACR4H,cAAe,SAEhBF,EAAS/J,SAAS,QAClBqB,EAAQrB,SAAS,QACjB,MAAMkK,EAAU,KACfH,EAASI,SACT9I,EAAQ8I,SACR,MAAMC,EAAWC,IAChBA,EAAMC,kBAEPtM,EAAEuM,QAAQtK,GAAG,cAAemK,GAC5BxD,WAAW,KACV5I,EAAEuM,QAAQ5G,IAAI,cAAeyG,GAC7BG,OAAOC,oBAAoB,UAAWC,GAAgB,IACpD,MAEEA,EAAkBJ,KAGhB,MAAO,MAAO,aAAc,cAAe,cAAe,iBAAkB,eAAgB,UAAUK,SAASL,EAAMM,OAC3HN,EAAMC,iBACND,EAAMO,kBACNV,MAGF,IAAIW,EAAaC,EACjBf,EAAS9J,GAAG,wBAA0BoK,SACjBU,IAAhBF,IACHA,EAAcR,EAAMW,MACpBF,EAAcT,EAAMY,OAEjB5H,KAAK6H,MAAML,EAAcR,EAAMW,MAAOF,EAAcT,EAAMY,OApDnC,IAqD1Bf,MAGFH,EAAS9J,GAAG,mCAAqCoK,IAChDA,EAAMC,iBACNJ,MAIDK,OAAOY,iBAAiB,UAAWV,GAAgB,GAGpD,SAASW,IAERvB,+BAA6CwB,mBAAmBC,KAAKC,WADnDC,QAAQ,QAI3B,SAASC,IACR5B,EAAgB,oCAGjB,SAAS6B,IACR,IAAIvF,EAAO1H,GACVkD,IAAK,8BACL7C,MAAOC,EAAgB,SACvBF,MAAO,gBAEP0K,WAAY,IACZC,YAAa,IACbmC,cAAcC,EAAMC,EAAQC,GAC3B,MAEMzJ,GAAU8D,EAAK3F,aAAe2F,EAAKjE,SAAS1B,cAAgB,EAC5DuL,EACFH,EAAKI,EAAI3J,EADP0J,EAEFH,EAAKK,EAAI5J,EAAS8D,EAAK+F,UAAU9F,cAF/B2F,EAGEH,EAAK1K,MAAQiF,EAAK3F,aAAe2F,EAAKjE,SAAS1B,aAHjDuL,EAIGH,EAAKzJ,OAASgE,EAAKC,cAAgBD,EAAKjE,SAASkE,cAEpD+F,EATa,EAUX9I,KAAK+I,MAAML,EAVA,GASbI,EARc,GAUX9I,KAAK+I,MAAML,EAVA,IAYdM,GACLL,EAAGD,EAAe1J,EAClB4J,EAAGF,EAAe1J,EAAS8D,EAAK+F,UAAU9F,cAC1ClF,MAAOiL,EAAuBhG,EAAK3F,aAAe2F,EAAKjE,SAAS1B,aAChE2B,OAAQgK,EAAwBhG,EAAKC,cAAgBD,EAAKjE,SAASkE,eAQpE,OANgB,IAAZyF,IACHQ,EAASL,EAAIJ,EAAKI,EAAIJ,EAAK1K,MAAQmL,EAASnL,QAE7B,IAAZ4K,IACHO,EAASJ,EAAIL,EAAKK,EAAIL,EAAKzJ,OAASkK,EAASlK,QAEvCkK,KAWT,OAAO,IAAI/N,EAAK6H,GAGjB,SAASmG,IACR,IAAInG,EAAO1H,GACVkD,IAAK,iCACL7C,MAAOC,EAAgB,cACvBF,MAAO,aACP0K,WAAY,IACZC,YAAa,IACbE,cAAe,IACfC,eAAgB,MAEjB,OAAO,IAAIrL,EAAK6H,GAGjB,SAASoG,IACR,IAAIpG,EAAO1H,GACVkD,IAAK,oCACL7C,MAAOC,EAAgB,WACvBF,MAAO,uCACP0K,WAAY,IACZC,YAAa,IACbE,cAAe,IACfC,eAAgB,IAEhB6C,gBAAgB,IAEjB,MAAMC,EAAUzO,EAAE,SAASkC,KAC1BsC,SAAU,QACVM,IAAK,EACL1B,KAAM,EACNF,MAAO,OACPiB,OAAQ,OACRQ,WAAY,yDACZP,gBAAiB,QACjBY,OAAQxE,EAAQwL,QAAU,MACxBhK,SAAS,QAkBZ,OAjBA4G,WAAW,KACV6F,EAAQtC,UACN,KACHhE,EAAKjE,SAASqC,KAAK,UAAUtE,GAAG,cAAe,KAC9CwM,EAAQtC,WAEThE,EAAKjE,SAASqC,KAAK,UAAUtE,GAAG,mBAAoB,KACnDwM,EAAQtC,SAQRhE,EAAKtH,MAAM,mCAEL,IAAIP,EAAK6H,GAGjB,SAASuG,EAASC,GAEjB,IACI1G,EADiB0G,EAGjBxG,EAAO1H,GACVkD,IAAK,gCAAkCgL,EAAW,YAActB,mBAAmBsB,GAAY,IAC/F7N,MAAOC,EAAgB,eACvBF,MAAOoH,EAKPsD,WAAYlG,KAAKC,IAAI,IAAkB,GAAbiG,YAC1BC,YAAanG,KAAKC,IAAI,IAAmB,GAAdkG,eAE5B,OAAO,IAAIlL,EAAK6H,GApWjBJ,EAAQ6G,kBAAmB,EAuH3BvG,EAAMuG,kBAAmB,EA8BzBnD,EAAcmD,kBAAmB,EAiNjCF,EAASE,kBAAmB,EAE5B,IACIC,EAAmC,SAAUC,EAAoBnG,GAOnE3I,EAAE+O,UAAU,2CAA4C,KACnDD,EACH9O,EAAE+O,UAAU,yCAA0C,KACrD/O,EAAE+O,UAAU,gDAAiD,KAC5DpG,QAIFA,OAOJ,MAAMqG,EAAyB,KAC9B,MAAMxE,EAASa,SAAS4D,cAAc,UACtC,IAAIC,EACJ,IACCA,EAAK1E,EAAO2E,WAAW,UACtB,MAAOnB,GACRkB,EAAK,KAGN,MAAME,IAAoBF,EACpBG,KAAuB9C,OAAO+C,eAAgB/C,OAAOgD,oBAE3D,OAAOH,GAAmBC,GAG3B,IAAIG,EACAC,EACAC,EACAC,EACAC,GAAiB,EAErB,SAASC,EAAW7H,GACnB,MAAM8H,EAAkB9H,GAChB,IAAIe,QAAQ,CAACC,EAASC,KAC5B/I,EAAgBgJ,eAAe,WACrBC,UAAUC,WAAW,MAC3BC,SAASrB,EAAW,SAAUsB,EAAKC,GACrC,GAAID,EACH,OAAOL,EAAOK,GAEf,MAAME,EAAa,IAAIC,WAAWF,GAC5BG,EAAO,IAAIC,MAAMH,IACvBR,EAAQU,SAMNqG,EAAkB9F,MAAOjC,IAC9B,MAAM0B,QAAaoG,EAAe9H,GAOlC,OAHCgI,IAHgBC,IAAIC,gBAAgBxG,GAIpCyG,YAAajI,oBAAoBF,GAAW6B,QAAQ,gBAAiB,MAKjEuG,EAAanG,UAOlB,GAN+B,SAA3BwF,EAAQvN,IAAI,YACfyN,EAAiBU,aAGlBV,EAAiB7E,QAEb9C,EACH,GAAIA,EAAUsI,MAAM,mBAAoB,CACvC,MAAM5G,QAAaoG,EAAe9H,GAC5BgI,EAAMC,IAAIC,gBAAgBxG,GAChC8F,EAAOe,eAAeP,QAChB,GAAIhI,EAAUsI,MAAM,mBAC1BE,MAAM,8CACA,CACN,MAAMC,QAAcV,EAAgB/H,GACpCwH,EAAOkB,iBAAiBD,IAI1Bb,GAAiB,GAElB,GAAIF,EAEH,YADAU,IAGD,GAAIR,EACH,OAEDA,GAAiB,EAIjB,MAAMd,EAAqBE,IAE3BH,EAAiCC,EAAoB,WACpD,MAAM6B,GACLC,gBACCC,UACCC,OAAQ,gBACRjQ,MAAO,wBAERmP,IAAK,qCACLe,SAAU,WAKXC,eAAe,EACfC,qBAAuB5E,GACtBtD,QAAQmI,IACPC,oBAAoBC,IAAIrB,KAIvBjB,IACH6B,EAAeU,sBACdC,kBAAmB,IAAMvI,QAAQC,QAAQuD,OAAOgF,aAChDC,WAAY,KACX,MAAMC,EAAUlF,OAAOmF,mBAAmBF,aAC1C,OAAO5G,OAAO+G,KAAKF,GAASL,IAAK3P,KAE/BA,KAAAA,EACAmQ,wBAAyBH,EAAQhQ,OAIpCoQ,iBAAiB,GAElBlB,EAAemB,uBACdC,MAAQvN,UAAYwJ,EAAG,EAAGC,EAAG,IAC7B+D,WAAaxN,UAAYwJ,EAAG,EAAGC,EAAG,MAClCgE,UAAYzN,UAAYwJ,EAAG,EAAGC,EAAG,KAAOiE,MAAO,EAAG,IAClDC,UAAY3N,UAAYwJ,EAAG,IAAKC,EAAG,GAAKiE,MAAO,EAAG,OAGpD1C,EAAS,IAAI4C,OAAOzB,GAEpB,IAAI0B,EAAmBhH,SAAS4D,cAAc,OAC9CoD,EAAiBC,UAAUC,IAAI,2BAC/BF,EAAiBG,MAAMhO,SAAW,WAClC6N,EAAiBG,MAAMpP,KAAO,IAC9BiP,EAAiBG,MAAMC,MAAQ,IAC/BJ,EAAiBG,MAAM1N,IAAM,IAC7BuN,EAAiBG,MAAMzN,OAAS,IAChCsN,EAAiBG,MAAMvG,cAAgB,OACvCZ,SAASqH,KAAKC,YAAYN,GAE1B7C,EAAOoD,gBAAgBP,GAAkBtH,KAAK,KAC7CwB,OAAOsG,SAAWA,QAAQC,IAAI,oBAE9BrD,EAAUzP,EAAE,YAEJkC,KACPsC,SAAU,WACVpB,KAAM,EACN0B,IAAK,EACLE,OAAQxE,EAAQwL,YAGjB,MAAM+G,EAAe/S,MACfgT,EAAwBvR,GACrBkH,IACP,MAAMsK,EAAK,KACVtK,KAEDoK,EAAa9Q,GAAGR,EAAMwR,GAItB,MAHgB,KACfF,EAAapN,IAAIlE,EAAMwR,KAuG1B,IAAIC,GAjGJvD,MACiBwD,QAAUH,EAAqB,SAChDrD,EAAiByD,OAASJ,EAAqB,QAC/CrD,EAAiB0D,SAAWL,EAAqB,UACjDrD,EAAiB2D,cAAgB,CAACC,IACR,KAArBA,GAAgD,KAArBA,IAC9BA,EAAmB,IAEpB,MAAMC,EAAMnI,SAAS4D,cAAc,OAEnC,OADAuE,EAAI7P,IAAMxD,EAAQsT,YAAY,UAAWF,GAClCC,IAER7D,EAAiB+D,aAAe,MAC/BjE,EAAQvN,KACP8C,OAAQxE,EAAQwL,cAGlB2D,EAAiBgE,QAAUhE,EAAiB,GAAKF,EAAQ,GACzDE,EAAiBiE,SAAW,CAACC,GACV,YAAdA,GACIpE,EAAQmE,SAAS,YAI1BjE,EAAiB7E,MAAQ,MACnB2E,EAAQmE,SAAS,aACrBnE,EAAQxO,SAAS,WACjB0O,EAAiB+D,eACjBX,EAAa9O,eAAe,SAE5BwL,EAAQlJ,KAAK,gCAAgCuE,WAG/C6E,EAAiBmE,KAAO,MACnBrE,EAAQmE,SAAS,aACpBnE,EAAQjJ,YAAY,WACpBuM,EAAa9O,eAAe,WAI9B0L,EAAiBoE,SAAW,MAE3BtE,EAAQ1M,SAET4M,EAAiBU,WAAa,MAE7BZ,EAAQxM,SAGT0M,EAAiBqE,MAAQ,MAKxBxE,EAAOyE,UACPxE,EAAQtD,SAER4G,EAAa9O,eAAe,UAE5BuL,EAAS,KACTC,EAAU,KACVC,EAAc,KACdC,EAAmB,OAEpBA,EAAiBuE,SAAW,MAC3B,IAAIC,EAAY,cAChB,MAAMC,EAAQ3E,EAAQlJ,KAAK,8CAC3B,GAAI6N,EAAM5M,OAET,OADA2M,KAAeC,EAAMrS,kBACbyN,EAAO6E,kBACd,IAAK,UACJF,KAAeA,cACf,MACD,IAAK,SACJA,KAAeA,aAIlB,OAAOA,IAERxE,EAAiB2E,kBAAoB,SAKrC3E,EAAiB1N,GAAK,EAACsS,EAAY5L,KACf,iBAAf4L,EACH/E,EAAOgF,iBAAiB7L,GACC,gBAAf4L,GAGV1B,QAAQ4B,2BAA2BF,OAIrCpU,EAAQuU,gBAAgB/E,EAAkBxP,EAAQwU,wBAKlDjF,EAAc,IAAIpP,EAAKqP,GACvBH,EAAOoF,QAAQ,WACdjF,EAAiBqE,QACjBa,qBAAqB3B,GACrB4B,EAAkBC,sBAEnBvF,EAAOwF,WAAW,WACjBrF,EAAiBoE,aAGlBtE,EAAQxN,GAAG,UAAW,KACrB0N,EAAiB7E,UAElB2E,EAAQxN,GAAG,WAAY,KAGpBoJ,SAAS4J,eACT5J,SAAS4J,cAAcC,SACvB7J,SAAS4J,cAAcC,QAAQ,YAEhCvF,EAAiBmE,SAInB,MAAMgB,EAAoB,IAAIvU,EAC7BkP,EAAQlJ,KAAK,sBAAsB,IACjC4O,QAAQ,EAAMC,SAAS,IAMpBC,EAAU,KACQrV,EAAE,wCAAwCsV,UAClDnO,QAAQoO,IACjBA,EAASC,mBACbV,EAAkBW,kBAAkBF,GACpCA,EAASC,kBAAmB,KAIE,YAA5BhG,EAAO6E,iBACVS,EAAkBY,SAElBZ,EAAkBa,UAEnBzC,EAAS0C,sBAAsBP,IAEhCnC,EAAS0C,sBAAsBP,GAE/BjF,KACGnF,IAEHuF,MAAM,+BAAiCvF,GACvC4H,QAAQ5H,MAAMA,OAmBjB,SAAS4K,EAAY7N,GACpB9H,EAAgBgJ,eAAe,WACrBC,UAAUC,WAAW,MAC3BC,SAASrB,EAAW,OAAQ,SAAUsB,EAAKwM,GAC7C,GAAIxM,EACH,OAAOkH,MAAMlH,GAGd,IAAIgH,EAAQwF,EAAQxF,MAAM,yBAE1B5B,EADU4B,EAAQA,EAAM,GAAKwF,OAOhC,SAASC,EAAc/N,GACtB9H,EAAgBgJ,eAAe,WACrBC,UAAUC,WAAW,MAC3BC,SAASrB,EAAW,OAAQ,SAAUsB,EAAKwM,GAC7C,GAAIxM,EACH,OAAOkH,MAAMlH,GAEd0M,kBAAkBF,GAClB,IACCG,aAAaC,QAAQ,gBAAiBJ,GACtCG,aAAaC,QAAQ,qBAAsBlO,GAC1C,MAAOiD,SA1CZ4E,EAAWjB,kBAAmB,EA6B9BiH,EAAYjH,kBAAmB,EAmB/BmH,EAAcnH,kBAAmB,EAGjC,IAAIuH,GAuBHC,GAAIrO,EACJsO,IAAKtO,EACLuO,GAAIjO,EACJkO,IAAKxO,EACLyO,YAAazO,EACb0O,MAAO1O,EACP2O,IAAK3O,EACL4O,KAAM5O,EACN6O,IAAK7O,EACL7F,IAAK6F,EACL8O,EAAG9O,EACH+O,aAAc/O,EACdgP,QAAShP,EACTiP,cAAejP,EACfkP,UAAWlP,EACXmP,QAASnP,EACToP,EAAGpP,EACHf,IAAKe,EACLqP,IAAKrP,EACLsP,KAAMtP,EACNuP,IAAKvP,EACLwP,GAAIxP,EACJyP,KAAMzP,EACN+K,IAAK/K,EACL0P,KAAM1P,EACNqJ,IAAKrJ,EACL2P,MAAO3P,EACP4P,GAAI5P,EACJ6P,eAAgB7P,EAChB8P,WAAY9P,EACZ+P,GAAI/P,EACJgQ,IAAKhQ,EACLiQ,GAAIjQ,EACJkQ,GAAIlQ,EACJmQ,IAAKnQ,EACLoQ,QAASpQ,EACTqQ,YAAarQ,EACbsQ,IAAKtQ,EACLuQ,IAAKvQ,EAGLwQ,IAAKlQ,EACLmQ,IAAKnQ,EACLoQ,IAAKpQ,EACLqQ,IAAKrQ,EACLsQ,KAAMtQ,EACNuQ,IAAKvQ,EACLwQ,KAAMxQ,EACNyQ,IAAKzQ,EACL0Q,IAAK1Q,EACL2Q,IAAK3Q,EACL4Q,IAAK5Q,EACL6Q,IAAK7Q,EACL8Q,IAAK9Q,EACL+Q,IAAK/Q,EACLgR,IAAKhR,EACLiR,IAAKjR,EACLkR,GAAIlR,EACJmR,IAAKnR,EACLoR,IAAKpR,EACLqR,IAAKrR,EACLsR,IAAKtR,EACLuR,KAAMvR,EACNwR,KAAMxR,EACNyR,IAAKzR,EACL0R,IAAK1R,EACL2R,OAAQ3R,EACR4R,MAAO5R,EACP6R,IAAK7R,EAGL8R,IAAKtK,EACLuK,IAAKvK,EAGLwK,IAAK5O,EACL6O,IAAKzK,EACL0K,IAAK1K,EACL2K,IAAK3K,EACL4K,IAAK5K,EACL6K,IAAK7K,EACL8K,KAAM9K,EACN+K,IAAK/K,EACLgL,IAAKhL,EACLiL,MAAOjL,EAGPkL,IAAKlL,EACLmL,IAAKnL,EAGLoL,IAAKvM,EACL2I,KAAM3I,EACNsB,IAAK6F,EACLqF,MAAOnF,EACPoF,UAAWpF,GAIZ,SAASqF,EAAkBpT,GAI1B9H,EAAgBgJ,eAAe,WACrBC,UAAUC,WAAW,MAC3BiS,KAAKrT,EAAW,SAAUsB,EAAKgS,GACjC,GAAIhS,EACH,OAAOkH,MAAM,4BAA8BxI,EAAY,OAASsB,GAEjE,GAAIgS,EAAMC,cACT7M,EAAS1G,OACH,CACN,IAAIwT,EAAiBC,yBAAyBzT,GAC1C0T,EAAUvF,EAA4BqF,EAAeG,eACzD,GAAID,EAAS,CACZ,IAAKA,EAAQ9M,iBAEZ,YADA4B,MAAMkL,EAAQja,KAAO,kEAGtBia,EAAQ1T,QAERwI,MAAM,iCAAmCgL,EAAiB,eAsI/D,SAASza,EAAgB6a,GACxB,OACCC,mBAAoBD,cACpBE,mBAAoBF,eAItB,OACCR,kBAAAA,EACAW,sBAtID,SAA+BC,GAK9B,IAAIC,EAA8B,SAAUtb,GAC3Cqb,EAAYE,SAAS,IAAI9b,GACxBU,OAEC6M,CAACxN,EAAQgc,mBAAoBhc,EAAQsT,YAAY9S,EAAQib,OAAQzb,EAAQgc,uBAEvExb,MAGLsb,GACCpb,MAAO,cACP+a,OAAQ,cACRQ,KAAM,WAAchB,EAAkB,MAEtCiB,kBAAkB,IAEnBJ,GACCpb,MAAO,eACP+a,OAAQ,sBACRQ,KAAM,WAAchB,EAAkB,kBAEtCiB,kBAAkB,IAEnBJ,GACCpb,MAAO,uBACP+a,OAAQ,UACRQ,KAAM,WAAchB,EAAkB,0BAEtCiB,kBAAkB,IAEnBJ,GACCpb,MAAO,cACP+a,OAAQ,cACRQ,KAAM,WAAc1N,EAAS,iCAC7B2N,kBAAkB,IAEnBJ,GACCpb,MAAO,cACP+a,OAAQ,SACRQ,KAAM,WAAchB,EAAkB,iBAEtCiB,kBAAkB,IAEnBJ,GACCpb,MAAO,oBACP+a,OAAQ,oBACRQ,KAAM,WAAc1N,EAAS,8BAE9BuN,GACCpb,MAAO,QACP+a,OAAQ,QACRQ,KAAM/T,EACNiU,UAAU,IAEXL,GACCpb,MAAO,cACP+a,OAAQ,cACRQ,KAAM9Q,EACNgR,UAAU,IAEXL,GACCpb,MAAO,iBACP+a,OAAQ,UACRQ,KAAM3Q,EACN6Q,UAAU,IAEXL,GACCpb,MAAO,YACP+a,OAAQ,YACRQ,KAAMxQ,EACN0Q,UAAU,IAEXL,GACCpb,MAAO,UACP+a,OAAQ,UACRQ,KAAMrU,EACNuU,UAAU,IAEXL,GACCpb,MAAO,SACP+a,OAAQ,UACRQ,KAAMvM,EACNyM,UAAU,IAEXL,GACCpb,MAAO,WACP+a,OAAQ,QACRQ,KAAMhP,EACNkP,UAAU,IAEXL,GACCpb,MAAO,gBACP+a,OAAQ,QACRQ,KAAM3O,EACN6O,UAAU,IAEXL,GACCpb,MAAO,gBACP+a,OAAQ,QACRQ,KAAM1O,EACN4O,UAAU,IAEXL,GACCpb,MAAO,aACP+a,OAAQ,aACRQ,KAAM9N,EACNgO,UAAU,IAEXL,GACCpb,MAAO,UACP+a,OAAQ,UACRQ,KAAM7N,EACN+N,UAAU,IAGXN,EAAYO","file":"../programs.js","sourcesContent":["define([\n\t\"skylark-jquery\",\n\t\"./win98\",\n\t\"./filesystem-setup\",\n\t\"./helpers\",\n\t\"./FolderViewItem\",\n\t\"./iframe-windows\",\n\t\"./Task\",\n\t\"./visualizer-overlay\",\n\t\"./os-gui/$Window\"\n],function($,win98js,FilesystemSetup,helpers,FolderViewItem,iframeWindows,Task,VisualizerOverlay, $Window){\n\tlet make_iframe_window = iframeWindows.make_iframe_window;\n\n\tfunction show_help(options) {\n\t\tconst $help_window = $Window({\n\t\t\ttitle: options.title || \"Help Topics\",\n\t\t\ticons: iconsAtTwoSizes(\"chm\"),\n\t\t\tresizable: true,\n\t\t})\n\t\t$help_window.addClass(\"help-window\");\n\n\t\tlet ignore_one_load = true;\n\t\tlet back_length = 0;\n\t\tlet forward_length = 0;\n\n\t\tconst $main = $(E(\"div\")).addClass(\"main\");\n\t\tconst $toolbar = $(E(\"div\")).addClass(\"toolbar\");\n\t\tconst add_toolbar_button = (name, sprite_n, action_fn, enabled_fn) => {\n\t\t\tconst $button = $(\"<button class='lightweight'>\")\n\t\t\t\t.append($(\"<span>\").text(name))\n\t\t\t\t.appendTo($toolbar)\n\t\t\t\t.on(\"click\", () => {\n\t\t\t\t\taction_fn();\n\t\t\t\t});\n\t\t\t$(\"<div class='icon'/>\")\n\t\t\t\t.appendTo($button)\n\t\t\t\t.css({\n\t\t\t\t\tbackgroundPosition: `${-sprite_n * 55}px 0px`,\n\t\t\t\t});\n\t\t\tconst update_enabled = () => {\n\t\t\t\t$button[0].disabled = enabled_fn && !enabled_fn();\n\t\t\t};\n\t\t\tupdate_enabled();\n\t\t\t$help_window.on(\"click\", \"*\", update_enabled);\n\t\t\t$help_window.on(\"update-buttons\", update_enabled);\n\t\t\treturn $button;\n\t\t};\n\t\tconst measure_sidebar_width = () =>\n\t\t\t$contents.outerWidth() +\n\t\t\tparseFloat(getComputedStyle($contents[0]).getPropertyValue(\"margin-left\")) +\n\t\t\tparseFloat(getComputedStyle($contents[0]).getPropertyValue(\"margin-right\")) +\n\t\t\t$resizer.outerWidth();\n\t\tconst $hide_button = add_toolbar_button(\"Hide\", 0, () => {\n\t\t\tconst toggling_width = measure_sidebar_width();\n\t\t\t$contents.hide();\n\t\t\t$resizer.hide();\n\t\t\t$hide_button.hide();\n\t\t\t$show_button.show();\n\t\t\t$help_window.width($help_window.width() - toggling_width);\n\t\t\t$help_window.css(\"left\", $help_window.offset().left + toggling_width);\n\t\t});\n\t\tconst $show_button = add_toolbar_button(\"Show\", 5, () => {\n\t\t\t$contents.show();\n\t\t\t$resizer.show();\n\t\t\t$show_button.hide();\n\t\t\t$hide_button.show();\n\t\t\tconst toggling_width = measure_sidebar_width();\n\t\t\t$help_window.width($help_window.width() + toggling_width);\n\t\t\t$help_window.css(\"left\", $help_window.offset().left - toggling_width);\n\t\t\t// $help_window.applyBounds() would push the window to fit (before trimming it only if needed)\n\t\t\t// Trim the window to fit (especially for if maximized)\n\t\t\tif ($help_window.offset().left < 0) {\n\t\t\t\t$help_window.width($help_window.width() + $help_window.offset().left);\n\t\t\t\t$help_window.css(\"left\", 0);\n\t\t\t}\n\t\t}).hide();\n\t\tadd_toolbar_button(\"Back\", 1, () => {\n\t\t\t$iframe[0].contentWindow.history.back();\n\t\t\tignore_one_load = true;\n\t\t\tback_length -= 1;\n\t\t\tforward_length += 1;\n\t\t}, () => back_length > 0);\n\t\tadd_toolbar_button(\"Forward\", 2, () => {\n\t\t\t$iframe[0].contentWindow.history.forward();\n\t\t\tignore_one_load = true;\n\t\t\tforward_length -= 1;\n\t\t\tback_length += 1;\n\t\t}, () => forward_length > 0);\n\t\tadd_toolbar_button(\"Options\", 3, () => { }, () => false); // TODO: hotkey and underline on O\n\t\tadd_toolbar_button(\"Web Help\", 4, () => {\n\t\t\tiframe.src = \"help/online_support.htm\";\n\t\t});\n\n\t\tconst $iframe = $(\"<iframe sandbox='allow-same-origin allow-scripts allow-forms allow-modals allow-popups allow-downloads'>\")\n\t\t\t.attr({ src: \"help/default.html\" })\n\t\t\t.addClass(\"inset-deep\");\n\t\tconst iframe = $iframe[0];\n\t\tenhance_iframe(iframe);\n\t\tiframe.$window = $help_window; // for focus handling integration\n\t\tconst $resizer = $(E(\"div\")).addClass(\"resizer\");\n\t\tconst $contents = $(E(\"ul\")).addClass(\"contents inset-deep\");\n\n\t\t// TODO: fix race conditions\n\t\t$iframe.on(\"load\", () => {\n\t\t\tif (!ignore_one_load) {\n\t\t\t\tback_length += 1;\n\t\t\t\tforward_length = 0;\n\t\t\t}\n\t\t\tiframe.contentWindow.location.href\n\t\t\tignore_one_load = false;\n\t\t\t$help_window.triggerHandler(\"update-buttons\");\n\t\t});\n\n\t\t$main.append($contents, $resizer, $iframe);\n\t\t$help_window.$content.append($toolbar, $main);\n\n\t\t$help_window.css({ width: 800, height: 600 });\n\n\t\t$iframe.attr({ name: \"help-frame\" });\n\t\t$iframe.css({\n\t\t\tbackgroundColor: \"white\",\n\t\t\tborder: \"\",\n\t\t\tmargin: \"1px\",\n\t\t});\n\t\t$contents.css({\n\t\t\tmargin: \"1px\",\n\t\t});\n\t\t$help_window.center();\n\n\t\t$main.css({\n\t\t\tposition: \"relative\", // for resizer\n\t\t});\n\n\t\tconst resizer_width = 4;\n\t\t$resizer.css({\n\t\t\tcursor: \"ew-resize\",\n\t\t\twidth: resizer_width,\n\t\t\tboxSizing: \"border-box\",\n\t\t\tbackground: \"var(--ButtonFace)\",\n\t\t\tborderLeft: \"1px solid var(--ButtonShadow)\",\n\t\t\tboxShadow: \"inset 1px 0 0 var(--ButtonHilight)\",\n\t\t\ttop: 0,\n\t\t\tbottom: 0,\n\t\t\tzIndex: 1,\n\t\t});\n\t\t$resizer.on(\"pointerdown\", (e) => {\n\t\t\tlet pointermove, pointerup;\n\t\t\tconst getPos = (e) =>\n\t\t\t\tMath.min($help_window.width() - 100, Math.max(20,\n\t\t\t\t\te.clientX - $help_window.$content.offset().left\n\t\t\t\t));\n\t\t\t$G.on(\"pointermove\", pointermove = (e) => {\n\t\t\t\t$resizer.css({\n\t\t\t\t\tposition: \"absolute\",\n\t\t\t\t\tleft: getPos(e)\n\t\t\t\t});\n\t\t\t\t$contents.css({\n\t\t\t\t\tmarginRight: resizer_width,\n\t\t\t\t});\n\t\t\t});\n\t\t\t$G.on(\"pointerup\", pointerup = (e) => {\n\t\t\t\t$G.off(\"pointermove\", pointermove);\n\t\t\t\t$G.off(\"pointerup\", pointerup);\n\t\t\t\t$resizer.css({\n\t\t\t\t\tposition: \"\",\n\t\t\t\t\tleft: \"\"\n\t\t\t\t});\n\t\t\t\t$contents.css({\n\t\t\t\t\tflexBasis: getPos(e) - resizer_width,\n\t\t\t\t\tmarginRight: \"\",\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\tconst parse_object_params = $object => {\n\t\t\t// parse an $(<object>) to a plain object of key value pairs\n\t\t\tconst object = {};\n\t\t\tfor (const param of $object.children(\"param\").get()) {\n\t\t\t\tobject[param.name] = param.value;\n\t\t\t}\n\t\t\treturn object;\n\t\t};\n\n\t\tlet $last_expanded;\n\n\t\tconst make_$item = text => {\n\t\t\tconst $item = $(E(\"div\")).addClass(\"item\").text(text);\n\t\t\t$item.on(\"mousedown\", () => {\n\t\t\t\t$contents.find(\".item\").removeClass(\"selected\");\n\t\t\t\t$item.addClass(\"selected\");\n\t\t\t});\n\t\t\t$item.on(\"click\", () => {\n\t\t\t\tconst $li = $item.parent();\n\t\t\t\tif ($li.is(\".folder\")) {\n\t\t\t\t\tif ($last_expanded) {\n\t\t\t\t\t\t$last_expanded.not($li).removeClass(\"expanded\");\n\t\t\t\t\t}\n\t\t\t\t\t$li.toggleClass(\"expanded\");\n\t\t\t\t\t$last_expanded = $li;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn $item;\n\t\t};\n\n\t\tconst $default_item_li = $(E(\"li\")).addClass(\"page\");\n\t\t$default_item_li.append(make_$item(\"Welcome to Help\").on(\"click\", () => {\n\t\t\t$iframe.attr({ src: \"help/default.html\" });\n\t\t}));\n\t\t$contents.append($default_item_li);\n\n\t\tfunction renderItemFromContents(source_li, $folder_items_ul) {\n\t\t\tconst object = parse_object_params($(source_li).children(\"object\"));\n\t\t\tif ($(source_li).find(\"li\").length > 0) {\n\n\t\t\t\tconst $folder_li = $(E(\"li\")).addClass(\"folder\");\n\t\t\t\t$folder_li.append(make_$item(object.Name));\n\t\t\t\t$contents.append($folder_li);\n\n\t\t\t\tconst $folder_items_ul = $(E(\"ul\"));\n\t\t\t\t$folder_li.append($folder_items_ul);\n\n\t\t\t\t$(source_li).children(\"ul\").children().get().forEach((li) => {\n\t\t\t\t\trenderItemFromContents(li, $folder_items_ul);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst $item_li = $(E(\"li\")).addClass(\"page\");\n\t\t\t\t$item_li.append(make_$item(object.Name).on(\"click\", () => {\n\t\t\t\t\t$iframe.attr({ src: `${options.root}/${object.Local}` });\n\t\t\t\t}));\n\t\t\t\tif ($folder_items_ul) {\n\t\t\t\t\t$folder_items_ul.append($item_li);\n\t\t\t\t} else {\n\t\t\t\t\t$contents.append($item_li);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t$.get(options.contentsFile, hhc => {\n\t\t\t$($.parseHTML(hhc)).filter(\"ul\").children().get().forEach((li) => {\n\t\t\t\trenderItemFromContents(li, null);\n\t\t\t});\n\t\t});\n\n\t\t// @TODO: keyboard accessability\n\t\t// $help_window.on(\"keydown\", (e)=> {\n\t\t// \tswitch(e.keyCode){\n\t\t// \t\tcase 37:\n\t\t// \t\t\tshow_error_message(\"MOVE IT\");\n\t\t// \t\t\tbreak;\n\t\t// \t}\n\t\t// });\n\t\tvar task = new Task($help_window);\n\t\ttask.$help_window = $help_window;\n\t\treturn task;\n\t}\n\n\tfunction Notepad(file_path) {\n\t\t// TODO: DRY the default file names and title code (use document.title of the page in the iframe, in make_iframe_window)\n\t\tvar document_title = file_path ? file_name_from_path(file_path) : \"Untitled\";\n\t\tvar win_title = document_title + \" - Notepad\";\n\t\t// TODO: focus existing window if file is currently open?\n\n\t\tvar $win = make_iframe_window({\n\t\t\tsrc: \"programs/notepad/index.html\" + (file_path ? (\"?path=\" + file_path) : \"\"),\n\t\t\ticons: iconsAtTwoSizes(\"notepad\"),\n\t\t\ttitle: win_title,\n\t\t\touterWidth: 480,\n\t\t\touterHeight: 321,\n\t\t\tresizable: true,\n\t\t});\n\t\treturn new Task($win);\n\t}\n\tNotepad.acceptsFilePaths = true;\n\n\tfunction Paint(file_path) {\n\t\tvar $win = make_iframe_window({\n\t\t\tsrc: \"programs/jspaint/index.html\",\n\t\t\ticons: iconsAtTwoSizes(\"paint\"),\n\t\t\t// NOTE: in Windows 98, \"untitled\" is lowercase, but TODO: we should just make it consistent\n\t\t\ttitle: \"untitled - Paint\",\n\t\t\touterWidth: 275,\n\t\t\touterHeight: 400,\n\t\t\tminOuterWidth: 275,\n\t\t\tminOuterHeight: 400,\n\t\t});\n\n\t\tvar contentWindow = $win.$iframe[0].contentWindow;\n\n\t\tvar waitUntil = function (test, interval, callback) {\n\t\t\tif (test()) {\n\t\t\t\tcallback();\n\t\t\t} else {\n\t\t\t\tsetTimeout(waitUntil, interval, test, interval, callback);\n\t\t\t}\n\t\t};\n\n\t\tconst systemHooks = {\n\t\t\treadBlobFromHandle: (file_path) => {\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tFilesystemSetup.withFilesystem(() => {\n\t\t\t\t\t\tvar fs = BrowserFS.BFSRequire(\"fs\");\n\t\t\t\t\t\tfs.readFile(file_path, (err, buffer) => {\n\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst byte_array = new Uint8Array(buffer);\n\t\t\t\t\t\t\tconst blob = new Blob([byte_array]);\n\t\t\t\t\t\t\tconst file_name = file_path.replace(/.*\\//g, \"\");\n\t\t\t\t\t\t\tconst file = new File([blob], file_name);\n\t\t\t\t\t\t\tresolve(file);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\twriteBlobToHandle: async (file_path, blob) => {\n\t\t\t\tconst arrayBuffer = await blob.arrayBuffer();\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tFilesystemSetup.withFilesystem(()=> {\n\t\t\t\t\t\tconst fs = BrowserFS.BFSRequire(\"fs\");\n\t\t\t\t\t\tconst { Buffer } = BrowserFS.BFSRequire(\"buffer\");\n\t\t\t\t\t\tconst buffer = Buffer.from(arrayBuffer);\n\t\t\t\t\t\tfs.writeFile(file_path, buffer, (err)=> {\n\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetWallpaperCentered: (canvas) => {\n\t\t\t\tcanvas.toBlob((blob) => {\n\t\t\t\t\tsetDesktopWallpaper(blob, \"no-repeat\", true);\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetWallpaperTiled: (canvas) => {\n\t\t\t\tcanvas.toBlob((blob) => {\n\t\t\t\t\tsetDesktopWallpaper(blob, \"repeat\", true);\n\t\t\t\t});\n\t\t\t},\n\t\t};\n\n\t\t// it seems like I should be able to use onload here, but when it works (overrides the function),\n\t\t// it for some reason *breaks the scrollbar styling* in jspaint\n\t\t// I don't know what's going on there\n\n\t\t// contentWindow.addEventListener(\"load\", function(){\n\t\t// $(contentWindow).on(\"load\", function(){\n\t\t// $win.$iframe.load(function(){\n\t\t// $win.$iframe[0].addEventListener(\"load\", function(){\n\t\twaitUntil(()=> contentWindow.systemHooks, 500, ()=> {\n\t\t\tObject.assign(contentWindow.systemHooks, systemHooks);\n\n\t\t\tlet $help_window;\n\t\t\tcontentWindow.show_help = () => {\n\t\t\t\tif ($help_window) {\n\t\t\t\t\t$help_window.focus();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t$help_window = show_help({\n\t\t\t\t\ttitle: \"Paint Help\",\n\t\t\t\t\tcontentsFile: \"programs/jspaint/help/mspaint.hhc\",\n\t\t\t\t\troot: \"programs/jspaint/help\",\n\t\t\t\t}).$help_window;\n\t\t\t\t$help_window.on(\"close\", () => {\n\t\t\t\t\t$help_window = null;\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tif (file_path) {\n\t\t\t\t// window.initial_system_file_handle = ...; is too late to set this here\n\t\t\t\t// contentWindow.open_from_file_handle(...); doesn't exist\n\t\t\t\tsystemHooks.readBlobFromHandle(file_path).then(file => {\n\t\t\t\t\tif (file) {\n\t\t\t\t\t\tcontentWindow.open_from_file(file, file_path);\n\t\t\t\t\t}\n\t\t\t\t}, (error) => {\n\t\t\t\t\t// this handler may not always called for errors, sometimes error message is shown via readBlobFromHandle\n\t\t\t\t\tcontentWindow.show_error_message(`Failed to open file ${file_path}`, error);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvar old_update_title = contentWindow.update_title;\n\t\t\tcontentWindow.update_title = () => {\n\t\t\t\told_update_title();\n\t\t\t\t$win.title(contentWindow.document.title);\n\t\t\t};\n\t\t});\n\n\t\treturn new Task($win);\n\t}\n\tPaint.acceptsFilePaths = true;\n\n\tfunction Minesweeper() {\n\t\tvar $win = make_iframe_window({\n\t\t\tsrc: \"programs/minesweeper/index.html\",\n\t\t\ticons: iconsAtTwoSizes(\"minesweeper\"),\n\t\t\ttitle: \"Minesweeper\",\n\t\t\tinnerWidth: 280,\n\t\t\tinnerHeight: 320 + 21,\n\t\t\tresizable: false,\n\t\t});\n\t\treturn new Task($win);\n\t}\n\n\tfunction SoundRecorder(file_path) {\n\t\t// TODO: DRY the default file names and title code (use document.title of the page in the iframe, in make_iframe_window)\n\t\tvar document_title = file_path ? file_name_from_path(file_path) : \"Sound\";\n\t\tvar win_title = document_title + \" - Sound Recorder\";\n\t\t// TODO: focus existing window if file is currently open?\n\t\tvar $win = make_iframe_window({\n\t\t\tsrc: \"programs/sound-recorder/index.html\" + (file_path ? (\"?path=\" + file_path) : \"\"),\n\t\t\ticons: iconsAtTwoSizes(\"speaker\"),\n\t\t\ttitle: win_title,\n\t\t\tinnerWidth: 270,\n\t\t\tinnerHeight: 108 + 21,\n\t\t\tminInnerWidth: 270,\n\t\t\tminInnerHeight: 108 + 21,\n\t\t});\n\t\treturn new Task($win);\n\t}\n\tSoundRecorder.acceptsFilePaths = true;\n\n\tfunction Solitaire() {\n\t\tvar $win = make_iframe_window({\n\t\t\tsrc: \"programs/js-solitaire/index.html\",\n\t\t\ticons: iconsAtTwoSizes(\"solitaire\"),\n\t\t\ttitle: \"Solitaire\",\n\t\t\tinnerWidth: 585,\n\t\t\tinnerHeight: 384 + 21,\n\t\t});\n\t\treturn new Task($win);\n\t}\n\n\tfunction showScreensaver(iframeSrc) {\n\t\tconst mouseDistanceToExit = 15;\n\t\tconst $iframe = $(\"<iframe>\").attr(\"src\", iframeSrc);\n\t\tconst $backing = $(\"<div>\");\n\t\t$backing.css({\n\t\t\tposition: \"fixed\",\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\twidth: \"100%\",\n\t\t\theight: \"100%\",\n\t\t\tzIndex: $Window.Z_INDEX + 9998,\n\t\t\tcursor: \"none\",\n\t\t\tbackgroundColor: \"black\",\n\t\t});\n\t\t$iframe.css({\n\t\t\tposition: \"fixed\",\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\twidth: \"100%\",\n\t\t\theight: \"100%\",\n\t\t\tzIndex: $Window.Z_INDEX + 9999,\n\t\t\tborder: 0,\n\t\t\tpointerEvents: \"none\",\n\t\t});\n\t\t$backing.appendTo(\"body\");\n\t\t$iframe.appendTo(\"body\");\n\t\tconst cleanUp = () => {\n\t\t\t$backing.remove();\n\t\t\t$iframe.remove();\n\t\t\tconst prevent = (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t};\n\t\t\t$(window).on(\"contextmenu\", prevent);\n\t\t\tsetTimeout(() => {\n\t\t\t\t$(window).off(\"contextmenu\", prevent);\n\t\t\t\twindow.removeEventListener(\"keydown\", keydownHandler, true);\n\t\t\t}, 500);\n\t\t};\n\t\tconst keydownHandler = (event) => {\n\t\t\t// Trying to let you change the display or capture the output\n\t\t\t// not allowing Ctrl+PrintScreen etc. because no modifiers\n\t\t\tif (!([\"F11\", \"F12\", \"ZoomToggle\", \"PrintScreen\", \"MediaRecord\", \"BrightnessDown\", \"BrightnessUp\", \"Dimmer\"].includes(event.key))) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tcleanUp();\n\t\t\t}\n\t\t};\n\t\tlet startMouseX, startMouseY;\n\t\t$backing.on(\"mousemove pointermove\", (event) => {\n\t\t\tif (startMouseX === undefined) {\n\t\t\t\tstartMouseX = event.pageX;\n\t\t\t\tstartMouseY = event.pageY;\n\t\t\t}\n\t\t\tif (Math.hypot(startMouseX - event.pageX, startMouseY - event.pageY) > mouseDistanceToExit) {\n\t\t\t\tcleanUp();\n\t\t\t}\n\t\t});\n\t\t$backing.on(\"mousedown pointerdown touchstart\", (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tcleanUp();\n\t\t});\n\t\t// useCapture needed for scenario where you hit Enter, with a desktop icon selected\n\t\t// (If it relaunches the screensaver, it's like you can't exit it!)\n\t\twindow.addEventListener(\"keydown\", keydownHandler, true);\n\t}\n\n\tfunction Pipes() {\n\t\tconst options = { hideUI: true };\n\t\tshowScreensaver(`programs/pipes/index.html#${encodeURIComponent(JSON.stringify(options))}`);\n\t}\n\n\tfunction FlowerBox() {\n\t\tshowScreensaver(\"programs/3D-FlowerBox/index.html\");\n\t}\n\n\tfunction CommandPrompt() {\n\t\tvar $win = make_iframe_window({\n\t\t\tsrc: \"programs/command/index.html\",\n\t\t\ticons: iconsAtTwoSizes(\"msdos\"),\n\t\t\ttitle: \"MS-DOS Prompt\",\n\t\t\t// TODO: default dimensions\n\t\t\tinnerWidth: 640,\n\t\t\tinnerHeight: 400,\n\t\t\tconstrainRect(rect, x_axis, y_axis) {\n\t\t\t\tconst char_width = 8;\n\t\t\t\tconst char_height = 16;\n\t\t\t\tconst border = ($win.outerWidth() - $win.$content.outerWidth()) / 2;\n\t\t\t\tconst inner_rect = {\n\t\t\t\t\tx: rect.x + border,\n\t\t\t\t\ty: rect.y + border + $win.$titlebar.outerHeight(),\n\t\t\t\t\twidth: rect.width - $win.outerWidth() + $win.$content.outerWidth(),\n\t\t\t\t\theight: rect.height - $win.outerHeight() + $win.$content.outerHeight(),\n\t\t\t\t};\n\t\t\t\tconst new_inner_rect = {\n\t\t\t\t\twidth: Math.floor(inner_rect.width / char_width) * char_width,\n\t\t\t\t\theight: Math.floor(inner_rect.height / char_height) * char_height,\n\t\t\t\t};\n\t\t\t\tconst new_rect = {\n\t\t\t\t\tx: inner_rect.x - border,\n\t\t\t\t\ty: inner_rect.y - border - $win.$titlebar.outerHeight(),\n\t\t\t\t\twidth: new_inner_rect.width + $win.outerWidth() - $win.$content.outerWidth(),\n\t\t\t\t\theight: new_inner_rect.height + $win.outerHeight() - $win.$content.outerHeight(),\n\t\t\t\t};\n\t\t\t\tif (x_axis === -1) {\n\t\t\t\t\tnew_rect.x = rect.x + rect.width - new_rect.width;\n\t\t\t\t}\n\t\t\t\tif (y_axis === -1) {\n\t\t\t\t\tnew_rect.y = rect.y + rect.height - new_rect.height;\n\t\t\t\t}\n\t\t\t\treturn new_rect;\n\t\t\t},\n\t\t\t// TODO: make the API simpler / more flexible like:\n\t\t\t// constrainDimensions({ innerWidth, innerHeight }) {\n\t\t\t// \tconst charWidth = 8;\n\t\t\t// \tconst charHeight = 16;\n\t\t\t// \tinnerWidth = Math.floor(innerWidth / charWidth) * charWidth;\n\t\t\t// \tinnerHeight = Math.floor(innerHeight / charHeight) * charHeight;\n\t\t\t// \treturn { innerWidth, innerHeight };\n\t\t\t// },\n\t\t});\n\t\treturn new Task($win);\n\t}\n\n\tfunction Calculator() {\n\t\tvar $win = make_iframe_window({\n\t\t\tsrc: \"programs/calculator/index.html\",\n\t\t\ticons: iconsAtTwoSizes(\"calculator\"),\n\t\t\ttitle: \"Calculator\",\n\t\t\tinnerWidth: 256,\n\t\t\tinnerHeight: 208 + 21,\n\t\t\tminInnerWidth: 256,\n\t\t\tminInnerHeight: 208 + 21,\n\t\t});\n\t\treturn new Task($win);\n\t}\n\n\tfunction Pinball() {\n\t\tvar $win = make_iframe_window({\n\t\t\tsrc: \"programs/pinball/space-cadet.html\",\n\t\t\ticons: iconsAtTwoSizes(\"pinball\"),\n\t\t\ttitle: \"3D Pinball for Windows - Space Cadet\",\n\t\t\tinnerWidth: 600,\n\t\t\tinnerHeight: 416 + 20, // @TODO: where's this 20 coming from?\n\t\t\tminInnerWidth: 600,\n\t\t\tminInnerHeight: 416 + 20,\n\t\t\t// resizable: false, // @TODO (maybe) once gray maximized button is implemented\n\t\t\toverride_alert: false, // to handle the alert as a fatal error, and to compensate for overzealous preventDefault()\n\t\t});\n\t\tconst $splash = $(\"<div>\").css({\n\t\t\tposition: \"fixed\",\n\t\t\ttop: 0,\n\t\t\tleft: 0,\n\t\t\twidth: \"100%\",\n\t\t\theight: \"100%\",\n\t\t\tbackground: \"url(images/pinball-splash.png) no-repeat center center\",\n\t\t\tbackgroundColor: \"black\",\n\t\t\tzIndex: $Window.Z_INDEX + 6000,\n\t\t}).appendTo(\"body\");\n\t\tsetTimeout(() => {\n\t\t\t$splash.remove(); // just in case\n\t\t}, 5000);\n\t\t$win.$content.find(\"iframe\").on(\"game-loaded\", () => { // custom event dispatched from within the iframe\n\t\t\t$splash.remove();\n\t\t});\n\t\t$win.$content.find(\"iframe\").on(\"game-load-failed\", () => { // custom event dispatched from within the iframe\n\t\t\t$splash.remove();\n\t\t\t// on some systems, if the game fails to load,\n\t\t\t// it may result in the canvas showing through to the desktop behind the browser window\n\t\t\t// let's call it a feature, tie it in thematically,\n\t\t\t// and pretend like we did it on purpose, to baffle and amuse.\n\t\t\t// This happens for me on Chrome on Ubuntu with Xfce, when coming out of suspend.\n\t\t\t// It says \"Could not create renderer / Couldn't find matching render driver\"\n\t\t\t// It keeps happening with live reload, but stops on a regular reload, or duplicating the tab.\n\t\t\t$win.title(\"Wormhole Window - Space Cadet\");\n\t\t});\n\t\treturn new Task($win);\n\t}\n\n\tfunction Explorer(address) {\n\t\t// TODO: DRY the default file names and title code (use document.title of the page in the iframe, in make_iframe_window)\n\t\tvar document_title = address;\n\t\tvar win_title = document_title;\n\t\t// TODO: focus existing window if folder is currently open\n\t\tvar $win = make_iframe_window({\n\t\t\tsrc: \"programs/explorer/index.html\" + (address ? (\"?address=\" + encodeURIComponent(address)) : \"\"),\n\t\t\ticons: iconsAtTwoSizes(\"folder-open\"),\n\t\t\ttitle: win_title,\n\t\t\t// this is based on one measurement, but it uses different sizes depending on the screen resolution,\n\t\t\t// and may be different for different Explorer window types (Microsoft Internet Explorer, \"Exploring\", normal Windows Explorer*),\n\t\t\t// and may store the window positions, even for different types or folders, so I might have a non-standard default size measurement.\n\t\t\t// *See different types (resized for posing this screenshot): https://imgur.com/nxAcT9C\n\t\t\tinnerWidth: Math.min(856, innerWidth * 0.9),\n\t\t\tinnerHeight: Math.min(547, innerHeight * 0.7),\n\t\t});\n\t\treturn new Task($win);\n\t}\n\tExplorer.acceptsFilePaths = true;\n\n\tvar webamp_bundle_loaded = false;\n\tvar load_winamp_bundle_if_not_loaded = function (includeButterchurn, callback) {\n\t\t// FIXME: webamp_bundle_loaded not actually set to true when loaded\n\t\t// TODO: also maybe handle already-loading-but-not-done\n\t\tif (webamp_bundle_loaded) {\n\t\t\tcallback();\n\t\t} else {\n\t\t\t// TODO: parallelize (if possible)\n\t\t\t$.getScript(\"programs/winamp/lib/webamp.bundle.min.js\", () => {\n\t\t\t\tif (includeButterchurn) {\n\t\t\t\t\t$.getScript(\"programs/winamp/lib/butterchurn.min.js\", () => {\n\t\t\t\t\t\t$.getScript(\"programs/winamp/lib/butterchurnPresets.min.js\", () => {\n\t\t\t\t\t\t\tcallback();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t// from https://github.com/jberg/butterchurn/blob/master/src/isSupported.js\n\tconst isButterchurnSupported = () => {\n\t\tconst canvas = document.createElement('canvas');\n\t\tlet gl;\n\t\ttry {\n\t\t\tgl = canvas.getContext('webgl2');\n\t\t} catch (x) {\n\t\t\tgl = null;\n\t\t}\n\n\t\tconst webGL2Supported = !!gl;\n\t\tconst audioApiSupported = !!(window.AudioContext || window.webkitAudioContext);\n\n\t\treturn webGL2Supported && audioApiSupported;\n\t};\n\n\tlet webamp;\n\tlet $webamp;\n\tlet winamp_task;\n\tlet winamp_interface;\n\tlet winamp_loading = false;\n\t// TODO: support opening multiple files at once\n\tfunction openWinamp(file_path) {\n\t\tconst filePathToBlob = (file_path) => {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tFilesystemSetup.withFilesystem(function () {\n\t\t\t\t\tvar fs = BrowserFS.BFSRequire(\"fs\");\n\t\t\t\t\tfs.readFile(file_path, function (err, buffer) {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst byte_array = new Uint8Array(buffer);\n\t\t\t\t\t\tconst blob = new Blob([byte_array]);\n\t\t\t\t\t\tresolve(blob);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tconst filePathToTrack = async (file_path) => {\n\t\t\tconst blob = await filePathToBlob(file_path);\n\t\t\tconst blob_url = URL.createObjectURL(blob);\n\t\t\t// TODO: revokeObjectURL\n\t\t\tconst track = {\n\t\t\t\turl: blob_url,\n\t\t\t\tdefaultName: file_name_from_path(file_path).replace(/\\.[a-z0-9]+$/i, \"\"),\n\t\t\t};\n\t\t\treturn track;\n\t\t};\n\n\t\tconst whenLoaded = async () => {\n\t\t\tif ($webamp.css(\"display\") === \"none\") {\n\t\t\t\twinamp_interface.unminimize();\n\t\t\t}\n\n\t\t\twinamp_interface.focus();\n\n\t\t\tif (file_path) {\n\t\t\t\tif (file_path.match(/(\\.wsz|\\.zip)$/i)) {\n\t\t\t\t\tconst blob = await filePathToBlob(file_path);\n\t\t\t\t\tconst url = URL.createObjectURL(blob);\n\t\t\t\t\twebamp.setSkinFromUrl(url);\n\t\t\t\t} else if (file_path.match(/(\\.m3u|\\.pls)$/i)) {\n\t\t\t\t\talert(\"Sorry, we don't support playlists yet.\");\n\t\t\t\t} else {\n\t\t\t\t\tconst track = await filePathToTrack(file_path);\n\t\t\t\t\twebamp.setTracksToPlay([track]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twinamp_loading = false;\n\t\t}\n\t\tif (winamp_task) {\n\t\t\twhenLoaded()\n\t\t\treturn;\n\t\t}\n\t\tif (winamp_loading) {\n\t\t\treturn; // TODO: queue up files?\n\t\t}\n\t\twinamp_loading = true;\n\n\t\t// This check creates a WebGL context, so don't do it if you try to open Winamp while it's opening or open.\n\t\t// (Otherwise it will lead to \"WARNING: Too many active WebGL contexts. Oldest context will be lost.\")\n\t\tconst includeButterchurn = isButterchurnSupported();\n\n\t\tload_winamp_bundle_if_not_loaded(includeButterchurn, function () {\n\t\t\tconst webamp_options = {\n\t\t\t\tinitialTracks: [{\n\t\t\t\t\tmetaData: {\n\t\t\t\t\t\tartist: \"DJ Mike Llama\",\n\t\t\t\t\t\ttitle: \"Llama Whippin' Intro\",\n\t\t\t\t\t},\n\t\t\t\t\turl: \"programs/winamp/mp3/llama-2.91.mp3\",\n\t\t\t\t\tduration: 5.322286,\n\t\t\t\t}],\n\t\t\t\t// initialSkin: {\n\t\t\t\t// \turl: \"programs/winamp/skins/base-2.91.wsz\",\n\t\t\t\t// },\n\t\t\t\tenableHotkeys: true,\n\t\t\t\thandleTrackDropEvent: (event) =>\n\t\t\t\t\tPromise.all(\n\t\t\t\t\t\tdragging_file_paths.map(filePathToTrack)\n\t\t\t\t\t),\n\t\t\t\t// TODO: filePickers\n\t\t\t};\n\t\t\tif (includeButterchurn) {\n\t\t\t\twebamp_options.__butterchurnOptions = {\n\t\t\t\t\timportButterchurn: () => Promise.resolve(window.butterchurn),\n\t\t\t\t\tgetPresets: () => {\n\t\t\t\t\t\tconst presets = window.butterchurnPresets.getPresets();\n\t\t\t\t\t\treturn Object.keys(presets).map((name) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t\tbutterchurnPresetObject: presets[name]\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tbutterchurnOpen: true,\n\t\t\t\t};\n\t\t\t\twebamp_options.__initialWindowLayout = {\n\t\t\t\t\tmain: { position: { x: 0, y: 0 } },\n\t\t\t\t\tequalizer: { position: { x: 0, y: 116 } },\n\t\t\t\t\tplaylist: { position: { x: 0, y: 232 }, size: [0, 4] },\n\t\t\t\t\tmilkdrop: { position: { x: 275, y: 0 }, size: [7, 12] }\n\t\t\t\t};\n\t\t\t}\n\t\t\twebamp = new Webamp(webamp_options);\n\n\t\t\tvar visual_container = document.createElement(\"div\");\n\t\t\tvisual_container.classList.add(\"webamp-visual-container\");\n\t\t\tvisual_container.style.position = \"absolute\";\n\t\t\tvisual_container.style.left = \"0\";\n\t\t\tvisual_container.style.right = \"0\";\n\t\t\tvisual_container.style.top = \"0\";\n\t\t\tvisual_container.style.bottom = \"0\";\n\t\t\tvisual_container.style.pointerEvents = \"none\";\n\t\t\tdocument.body.appendChild(visual_container);\n\t\t\t// Render after the skin has loaded.\n\t\t\twebamp.renderWhenReady(visual_container).then(() => {\n\t\t\t\twindow.console && console.log(\"Webamp rendered\");\n\n\t\t\t\t$webamp = $(\"#webamp\");\n\t\t\t\t// Bring window to front, initially and when clicked\n\t\t\t\t$webamp.css({\n\t\t\t\t\tposition: \"absolute\",\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: 0,\n\t\t\t\t\tzIndex: $Window.Z_INDEX++\n\t\t\t\t});\n\n\t\t\t\tconst $eventTarget = $({});\n\t\t\t\tconst makeSimpleListenable = (name) => {\n\t\t\t\t\treturn (callback) => {\n\t\t\t\t\t\tconst fn = () => {\n\t\t\t\t\t\t\tcallback();\n\t\t\t\t\t\t};\n\t\t\t\t\t\t$eventTarget.on(name, fn);\n\t\t\t\t\t\tconst dispose = () => {\n\t\t\t\t\t\t\t$eventTarget.off(name, fn);\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn dispose;\n\t\t\t\t\t};\n\t\t\t\t};\n\n\t\t\t\twinamp_interface = {};\n\t\t\t\twinamp_interface.onFocus = makeSimpleListenable(\"focus\");\n\t\t\t\twinamp_interface.onBlur = makeSimpleListenable(\"blur\");\n\t\t\t\twinamp_interface.onClosed = makeSimpleListenable(\"closed\");\n\t\t\t\twinamp_interface.getIconAtSize = (target_icon_size) => {\n\t\t\t\t\tif (target_icon_size !== 32 && target_icon_size !== 16) {\n\t\t\t\t\t\ttarget_icon_size = 32;\n\t\t\t\t\t}\n\t\t\t\t\tconst img = document.createElement(\"img\");\n\t\t\t\t\timg.src = helpers.getIconPath(\"winamp2\", target_icon_size);\n\t\t\t\t\treturn img;\n\t\t\t\t};\n\t\t\t\twinamp_interface.bringToFront = () => {\n\t\t\t\t\t$webamp.css({\n\t\t\t\t\t\tzIndex: $Window.Z_INDEX++\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t\twinamp_interface.element = winamp_interface[0] = $webamp[0]; // for checking z-index in window switcher\n\t\t\t\twinamp_interface.hasClass = (className) => { // also for window switcher (@TODO: clean this stuff up)\n\t\t\t\t\tif (className === \"focused\") {\n\t\t\t\t\t\treturn $webamp.hasClass(\"focused\");\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\t\t\t\twinamp_interface.focus = () => {\n\t\t\t\t\tif (!$webamp.hasClass(\"focused\")) {\n\t\t\t\t\t\t$webamp.addClass(\"focused\");\n\t\t\t\t\t\twinamp_interface.bringToFront();\n\t\t\t\t\t\t$eventTarget.triggerHandler(\"focus\");\n\t\t\t\t\t\t// @TODO: focus last focused window/control?\n\t\t\t\t\t\t$webamp.find(\"#main-window [tabindex='-1']\").focus();\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\twinamp_interface.blur = () => {\n\t\t\t\t\tif ($webamp.hasClass(\"focused\")) {\n\t\t\t\t\t\t$webamp.removeClass(\"focused\");\n\t\t\t\t\t\t$eventTarget.triggerHandler(\"blur\");\n\t\t\t\t\t\t// TODO: really blur\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\twinamp_interface.minimize = () => {\n\t\t\t\t\t// TODO: are these actually useful or does webamp hide it?\n\t\t\t\t\t$webamp.hide();\n\t\t\t\t};\n\t\t\t\twinamp_interface.unminimize = () => {\n\t\t\t\t\t// more to the point does this work necessarily??\n\t\t\t\t\t$webamp.show();\n\t\t\t\t\t// $webamp.focus();\n\t\t\t\t};\n\t\t\t\twinamp_interface.close = () => {\n\t\t\t\t\t// not allowing canceling close event in this case (generally used *by* an application (for \"Save changes?\"), not outside of it)\n\t\t\t\t\t// TODO: probably something like winamp_task.close()\n\t\t\t\t\t// winamp_interface.triggerHandler(\"close\");\n\t\t\t\t\t// winamp_interface.triggerHandler(\"closed\");\n\t\t\t\t\twebamp.dispose();\n\t\t\t\t\t$webamp.remove();\n\n\t\t\t\t\t$eventTarget.triggerHandler(\"closed\");\n\n\t\t\t\t\twebamp = null;\n\t\t\t\t\t$webamp = null;\n\t\t\t\t\twinamp_task = null;\n\t\t\t\t\twinamp_interface = null;\n\t\t\t\t};\n\t\t\t\twinamp_interface.getTitle = () => {\n\t\t\t\t\tlet taskTitle = \"Winamp 2.91\";\n\t\t\t\t\tconst $cell = $webamp.find(\".playlist-track-titles .track-cell.current\");\n\t\t\t\t\tif ($cell.length) {\n\t\t\t\t\t\ttaskTitle = `${$cell.text()} - Winamp`;\n\t\t\t\t\t\tswitch (webamp.getMediaStatus()) {\n\t\t\t\t\t\t\tcase \"STOPPED\":\n\t\t\t\t\t\t\t\ttaskTitle = `${taskTitle} [Stopped]`\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"PAUSED\":\n\t\t\t\t\t\t\t\ttaskTitle = `${taskTitle} [Paused]`\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn taskTitle;\n\t\t\t\t};\n\t\t\t\twinamp_interface.setMinimizeTarget = () => {\n\t\t\t\t\t// dummy function; it won't animate to the minimize target anyway\n\t\t\t\t\t// (did Winamp on Windows 98 animate minimize/restore?)\n\t\t\t\t};\n\t\t\t\t// @TODO: this wasn't supposed to be part of the API, but it's needed for the taskbar\n\t\t\t\twinamp_interface.on = (event_name, callback) => {\n\t\t\t\t\tif (event_name === \"title-change\") {\n\t\t\t\t\t\twebamp.onTrackDidChange(callback);\n\t\t\t\t\t} else if (event_name === \"icon-change\") {\n\t\t\t\t\t\t// icon will never change\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(`Unsupported event: ${event_name}`);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\thelpers.mustHaveMethods(winamp_interface, helpers.windowInterfaceMethods);\n\n\t\t\t\tlet raf_id;\n\t\t\t\tlet global_pointerdown;\n\n\t\t\t\twinamp_task = new Task(winamp_interface);\n\t\t\t\twebamp.onClose(function () {\n\t\t\t\t\twinamp_interface.close();\n\t\t\t\t\tcancelAnimationFrame(raf_id);\n\t\t\t\t\tvisualizerOverlay.fadeOutAndCleanUp();\n\t\t\t\t});\n\t\t\t\twebamp.onMinimize(function () {\n\t\t\t\t\twinamp_interface.minimize();\n\t\t\t\t});\n\n\t\t\t\t$webamp.on(\"focusin\", () => {\n\t\t\t\t\twinamp_interface.focus();\n\t\t\t\t});\n\t\t\t\t$webamp.on(\"focusout\", () => {\n\t\t\t\t\t// could use relatedTarget, no?\n\t\t\t\t\tif (\n\t\t\t\t\t\t!document.activeElement ||\n\t\t\t\t\t\t!document.activeElement.closest ||\n\t\t\t\t\t\t!document.activeElement.closest(\"#webamp\")\n\t\t\t\t\t) {\n\t\t\t\t\t\twinamp_interface.blur();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tconst visualizerOverlay = new VisualizerOverlay(\n\t\t\t\t\t$webamp.find(\".gen-window canvas\")[0],\n\t\t\t\t\t{ mirror: true, stretch: true },\n\t\t\t\t);\n\n\t\t\t\t// TODO: replace with setInterval\n\t\t\t\t// Note: can't access butterchurn canvas image data during a requestAnimationFrame here\n\t\t\t\t// because of double buffering\n\t\t\t\tconst animate = () => {\n\t\t\t\t\tconst windowElements = $(\".os-window, .window:not(.gen-window)\").toArray();\n\t\t\t\t\twindowElements.forEach(windowEl => {\n\t\t\t\t\t\tif (!windowEl.hasOverlayCanvas) {\n\t\t\t\t\t\t\tvisualizerOverlay.makeOverlayCanvas(windowEl);\n\t\t\t\t\t\t\twindowEl.hasOverlayCanvas = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (webamp.getMediaStatus() === \"PLAYING\") {\n\t\t\t\t\t\tvisualizerOverlay.fadeIn();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvisualizerOverlay.fadeOut();\n\t\t\t\t\t}\n\t\t\t\t\traf_id = requestAnimationFrame(animate);\n\t\t\t\t};\n\t\t\t\traf_id = requestAnimationFrame(animate);\n\n\t\t\t\twhenLoaded()\n\t\t\t}, (error) => {\n\t\t\t\t// TODO: show_error_message(\"Failed to load Webamp:\", error);\n\t\t\t\talert(\"Failed to render Webamp:\\n\\n\" + error);\n\t\t\t\tconsole.error(error);\n\t\t\t});\n\t\t});\n\t}\n\topenWinamp.acceptsFilePaths = true;\n\n\t/*\n\tfunction saveAsDialog(){\n\t\tvar $win = new $Window();\n\t\t$win.title(\"Save As\");\n\t\treturn $win;\n\t}\n\tfunction openFileDialog(){\n\t\tvar $win = new $Window();\n\t\t$win.title(\"Open\");\n\t\treturn $win;\n\t}\n\t*/\n\n\tfunction openURLFile(file_path) {\n\t\tFilesystemSetup.withFilesystem(function () {\n\t\t\tvar fs = BrowserFS.BFSRequire(\"fs\");\n\t\t\tfs.readFile(file_path, \"utf8\", function (err, content) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn alert(err);\n\t\t\t\t}\n\t\t\t\t// it's supposed to be an ini-style file, but lets handle files that are literally just a URL as well, just in case\n\t\t\t\tvar match = content.match(/URL\\s*=\\s*([^\\n\\r]+)/i);\n\t\t\t\tvar url = match ? match[1] : content;\n\t\t\t\tExplorer(url);\n\t\t\t});\n\t\t});\n\t}\n\topenURLFile.acceptsFilePaths = true;\n\n\tfunction openThemeFile(file_path) {\n\t\tFilesystemSetup.withFilesystem(function () {\n\t\t\tvar fs = BrowserFS.BFSRequire(\"fs\");\n\t\t\tfs.readFile(file_path, \"utf8\", function (err, content) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn alert(err);\n\t\t\t\t}\n\t\t\t\tloadThemeFromText(content);\n\t\t\t\ttry {\n\t\t\t\t\tlocalStorage.setItem(\"desktop-theme\", content);\n\t\t\t\t\tlocalStorage.setItem(\"desktop-theme-path\", file_path);\n\t\t\t\t} catch (error) {\n\t\t\t\t\t// no local storage\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\topenThemeFile.acceptsFilePaths = true;\n\n\t// Note: extensions must be lowercase here. This is used to implement case-insensitive matching.\n\tvar file_extension_associations = {\n\t\t// Fonts:\n\t\t// - eot (Embedded OpenType)\n\t\t// - otf (OpenType)\n\t\t// - ttf (TrueType)\n\t\t// - woff (Web Open Font Format)\n\t\t// - woff2 (Web Open Font Format 2)\n\t\t// - (also svg but that's mainly an image format)\n\n\t\t// Misc binary:\n\t\t// - wasm (WebAssembly)\n\t\t// - o (Object file)\n\t\t// - so (Shared Object)\n\t\t// - dll (Dynamic Link Library)\n\t\t// - exe (Executable file)\n\t\t// - a (static library)\n\t\t// - lib (static library)\n\t\t// - pdb (Program Debug database)\n\t\t// - idb (Intermediate Debug file)\n\t\t// - bcmap (Binary Character Map)\n\t\t// - bin (generic binary file extension)\n\n\t\t// Text:\n\t\t\"\": Notepad, // bare files such as LICENSE, Makefile, CNAME, etc.\n\t\tahk: Notepad,\n\t\tai: Paint,\n\t\tbat: Notepad,\n\t\tcheck_cache: Notepad,\n\t\tcmake: Notepad,\n\t\tcmd: Notepad,\n\t\tconf: Notepad,\n\t\tcpp: Notepad,\n\t\tcss: Notepad,\n\t\td: Notepad,\n\t\teditorconfig: Notepad,\n\t\tfilters: Notepad,\n\t\tgitattributes: Notepad,\n\t\tgitignore: Notepad,\n\t\tgitrepo: Notepad,\n\t\th: Notepad,\n\t\thhc: Notepad,\n\t\thhk: Notepad,\n\t\thtml: Notepad,\n\t\tini: Notepad,\n\t\tjs: Notepad,\n\t\tjson: Notepad,\n\t\tlog: Notepad,\n\t\tmake: Notepad,\n\t\tmap: Notepad,\n\t\tmarks: Notepad,\n\t\tmd: Notepad,\n\t\tprettierignore: Notepad,\n\t\tproperties: Notepad,\n\t\trc: Notepad,\n\t\trsp: Notepad,\n\t\tsh: Notepad,\n\t\tts: Notepad,\n\t\ttxt: Notepad,\n\t\tvcxproj: Notepad,\n\t\twebmanifest: Notepad,\n\t\txml: Notepad,\n\t\tyml: Notepad,\n\n\t\t// Images:\n\t\tbmp: Paint,\n\t\tcur: Paint,\n\t\teps: Paint,\n\t\tgif: Paint,\n\t\ticns: Paint,\n\t\tico: Paint,\n\t\tjpeg: Paint,\n\t\tjpg: Paint,\n\t\tkra: Paint,\n\t\tpbm: Paint,\n\t\tpdf: Paint, // yes I added PDF support to JS Paint (not all formats listed here are supported though)\n\t\tpdn: Paint,\n\t\tpgm: Paint,\n\t\tpng: Paint,\n\t\tpnm: Paint,\n\t\tppm: Paint,\n\t\tps: Paint,\n\t\tpsd: Paint,\n\t\tsvg: Paint,\n\t\ttga: Paint,\n\t\ttif: Paint,\n\t\ttiff: Paint,\n\t\twebp: Paint,\n\t\txbm: Paint,\n\t\txcf: Paint,\n\t\txcfbz2: Paint,\n\t\txcfgz: Paint,\n\t\txpm: Paint,\n\n\t\t// Winamp Skins:\n\t\twsz: openWinamp, // winamp skin zip\n\t\tzip: openWinamp, // MIGHT be a winamp skin zip, so might as well for now\n\n\t\t// Audio:\n\t\twav: SoundRecorder,\n\t\tmp3: openWinamp,\n\t\togg: openWinamp,\n\t\twma: openWinamp,\n\t\tm4a: openWinamp,\n\t\taac: openWinamp,\n\t\tflac: openWinamp,\n\t\tmka: openWinamp,\n\t\tmpc: openWinamp,\n\t\t\"mp+\": openWinamp,\n\n\t\t// Playlists:\n\t\tm3u: openWinamp,\n\t\tpls: openWinamp,\n\n\t\t// Misc:\n\t\thtm: Explorer,\n\t\thtml: Explorer,\n\t\turl: openURLFile,\n\t\ttheme: openThemeFile,\n\t\tthemepack: openThemeFile,\n\t};\n\n\t// Note: global systemExecuteFile called by explorer\n\tfunction systemExecuteFile(file_path) {\n\t\t// execute file with default handler\n\t\t// like the START command in CMD.EXE\n\n\t\tFilesystemSetup.withFilesystem(function () {\n\t\t\tvar fs = BrowserFS.BFSRequire(\"fs\");\n\t\t\tfs.stat(file_path, function (err, stats) {\n\t\t\t\tif (err) {\n\t\t\t\t\treturn alert(\"Failed to get info about \" + file_path + \"\\n\\n\" + err);\n\t\t\t\t}\n\t\t\t\tif (stats.isDirectory()) {\n\t\t\t\t\tExplorer(file_path);\n\t\t\t\t} else {\n\t\t\t\t\tvar file_extension = file_extension_from_path(file_path);\n\t\t\t\t\tvar program = file_extension_associations[file_extension.toLowerCase()];\n\t\t\t\t\tif (program) {\n\t\t\t\t\t\tif (!program.acceptsFilePaths) {\n\t\t\t\t\t\t\talert(program.name + \" does not support opening files via the virtual filesystem yet\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprogram(file_path);\n\t\t\t\t\t} else {\n\t\t\t\t\t\talert(\"No program is associated with \" + file_extension + \" files\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\n\n\tfunction initDesktopFolderView(folder_view) {\n\t\t// TODO: base all the desktop icons off of the filesystem\n\t\t// Note: `C:\\Windows\\Desktop` doesn't contain My Computer, My Documents, Network Neighborhood, Recycle Bin, or Internet Explorer,\n\t\t// or Connect to the Internet, or Setup MSN Internet Access,\n\t\t// whereas `Desktop` does (that's the full address it shows; it's one of them \"special locations\")\n\t\tvar add_icon_not_via_filesystem = function (options) {\n\t\t\tfolder_view.add_item(new FolderViewItem({\n\t\t\t\ticons: {\n\t\t\t\t\t// @TODO: know what sizes are available\n\t\t\t\t\t[helpers.DESKTOP_ICON_SIZE]: helpers.getIconPath(options.iconID, helpers.DESKTOP_ICON_SIZE),\n\t\t\t\t},\n\t\t\t\t...options,\n\t\t\t}));\n\t\t};\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"My Computer\",\n\t\t\ticonID: \"my-computer\",\n\t\t\topen: function () { systemExecuteFile(\"/\"); },\n\t\t\t// file_path: \"/\",\n\t\t\tis_system_folder: true,\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"My Documents\",\n\t\t\ticonID: \"my-documents-folder\",\n\t\t\topen: function () { systemExecuteFile(\"/my-documents\"); },\n\t\t\t// file_path: \"/my-documents/\",\n\t\t\tis_system_folder: true,\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"Network Neighborhood\",\n\t\t\ticonID: \"network\",\n\t\t\topen: function () { systemExecuteFile(\"/network-neighborhood\"); },\n\t\t\t// file_path: \"/network-neighborhood/\",\n\t\t\tis_system_folder: true,\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"Recycle Bin\",\n\t\t\ticonID: \"recycle-bin\",\n\t\t\topen: function () { Explorer(\"https://www.epa.gov/recycle/\"); },\n\t\t\tis_system_folder: true,\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"My Pictures\",\n\t\t\ticonID: \"folder\",\n\t\t\topen: function () { systemExecuteFile(\"/my-pictures\"); },\n\t\t\t// file_path: \"/my-pictures/\",\n\t\t\tis_system_folder: true,\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"Internet Explorer\",\n\t\t\ticonID: \"internet-explorer\",\n\t\t\topen: function () { Explorer(\"https://www.google.com/\"); }\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"Paint\",\n\t\t\ticonID: \"paint\",\n\t\t\topen: Paint,\n\t\t\tshortcut: true\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"Minesweeper\",\n\t\t\ticonID: \"minesweeper\",\n\t\t\topen: Minesweeper,\n\t\t\tshortcut: true\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"Sound Recorder\",\n\t\t\ticonID: \"speaker\",\n\t\t\topen: SoundRecorder,\n\t\t\tshortcut: true\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"Solitaire\",\n\t\t\ticonID: \"solitaire\",\n\t\t\topen: Solitaire,\n\t\t\tshortcut: true\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"Notepad\",\n\t\t\ticonID: \"notepad\",\n\t\t\topen: Notepad,\n\t\t\tshortcut: true\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"Winamp\",\n\t\t\ticonID: \"winamp2\",\n\t\t\topen: openWinamp,\n\t\t\tshortcut: true\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"3D Pipes\",\n\t\t\ticonID: \"pipes\",\n\t\t\topen: Pipes,\n\t\t\tshortcut: true\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"3D Flower Box\",\n\t\t\ticonID: \"pipes\",\n\t\t\topen: FlowerBox,\n\t\t\tshortcut: true\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"MS-DOS Prompt\",\n\t\t\ticonID: \"msdos\",\n\t\t\topen: CommandPrompt,\n\t\t\tshortcut: true\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"Calculator\",\n\t\t\ticonID: \"calculator\",\n\t\t\topen: Calculator,\n\t\t\tshortcut: true\n\t\t});\n\t\tadd_icon_not_via_filesystem({\n\t\t\ttitle: \"Pinball\",\n\t\t\ticonID: \"pinball\",\n\t\t\topen: Pinball,\n\t\t\tshortcut: true\n\t\t});\n\n\t\tfolder_view.arrange_icons();\n\n\t}\n\n\n\tfunction iconsAtTwoSizes(iconID) {\n\t\treturn {\n\t\t\t16: `images/icons/${iconID}-16x16.png`,\n\t\t\t32: `images/icons/${iconID}-32x32.png`,\n\t\t};\n\t}\n\n\treturn {\n\t\tsystemExecuteFile,\n\t\tinitDesktopFolderView\n\t};\n\n});"]}