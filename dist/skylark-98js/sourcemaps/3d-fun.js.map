{"version":3,"sources":["3d-fun.js"],"names":["cleanup","disable3D","$","css","transform","enable3D","animate","rAF_ID","requestAnimationFrame","cancelAnimationFrame","each","$window","this","el","offsetLeft","offsetTop","translate_match","style","match","translate_x","translate_y","parseFloat","offsetParent","clientWidth","innerWidth","clientHeight","innerHeight","transformOrigin","transformStyle","toggle3D","addEventListener","Konami","code"],"mappings":";;;;;;;CAAC,WACA,IAAIA,EAEJC,UAAY,WACPD,IACHA,IACAA,EAAU,MAEXE,EAAE,cAAcC,KACfC,UAAW,MAIbC,SAAW,WACVJ,YACA,IAAIK,EAAU,WACb,IAAIC,EAASC,sBAAsBF,GACnCN,EAAU,WACTS,qBAAqBF,IAOtBL,EAAE,cAAcQ,KAAK,WACpB,IAAIC,EAAUT,EAAEU,MAEZC,EAAKD,KACLE,EAAa,EACbC,EAAY,EAChB,EAAG,CACFD,GAAcD,EAAGC,WACjBC,GAAaF,EAAGE,UAChB,MAAMC,EAAkBH,EAAGI,MAAMb,UAAUc,MAAM,iCACjD,GAAIF,EAAiB,CACpB,MAAO,CAAEG,EAAaC,GAAeJ,EACrCF,GAAcO,WAAWF,GACzBJ,GAAaM,WAAWD,GAEzBP,EAAKA,EAAGS,mBACAT,GAETF,EAAQR,KACPC,2CAA4CU,GAAcF,KAAKW,YAAcC,YAAc,GAAKA,WAAa,mBAC1FT,GAAaH,KAAKa,aAAeC,aAAe,GAAKA,YAAc,SAEtFC,gBAAiB,UACjBC,eAAgB,mBAKnBtB,KAGDuB,SAAW,WACN7B,EACHC,YAEAI,YAIFyB,iBAAiB,UAAWC,OAAOC,KAAKH,WAhEzC","file":"../3d-fun.js","sourcesContent":["(function () {\n\tvar cleanup;\n\n\tdisable3D = function () {\n\t\tif (cleanup) {\n\t\t\tcleanup();\n\t\t\tcleanup = null;\n\t\t}\n\t\t$(\".os-window\").css({\n\t\t\ttransform: \"\"\n\t\t});\n\t};\n\n\tenable3D = function () {\n\t\tdisable3D();\n\t\tvar animate = function () {\n\t\t\tvar rAF_ID = requestAnimationFrame(animate);\n\t\t\tcleanup = function () {\n\t\t\t\tcancelAnimationFrame(rAF_ID);\n\t\t\t};\n\t\t\t// var everything = $(\"*\");\n\t\t\t// $(\"iframe\").each(function(){\n\t\t\t// \teverything = everything.add(this.contentWindow.$ && this.contentWindow.$(\"*\"));\n\t\t\t// });\n\t\t\t// everything.each(function(){\n\t\t\t$(\".os-window\").each(function () {\n\t\t\t\tvar $window = $(this);\n\t\t\t\t//var offset = $window.offset();//position();\n\t\t\t\tvar el = this;\n\t\t\t\tvar offsetLeft = 0;\n\t\t\t\tvar offsetTop = 0;\n\t\t\t\tdo {\n\t\t\t\t\toffsetLeft += el.offsetLeft;\n\t\t\t\t\toffsetTop += el.offsetTop;\n\t\t\t\t\tconst translate_match = el.style.transform.match(/translate\\((\\d+)px, (\\d+)px\\)/);\n\t\t\t\t\tif (translate_match) {\n\t\t\t\t\t\tconst [, translate_x, translate_y] = translate_match;\n\t\t\t\t\t\toffsetLeft += parseFloat(translate_x);\n\t\t\t\t\t\toffsetTop += parseFloat(translate_y);\n\t\t\t\t\t}\n\t\t\t\t\tel = el.offsetParent;\n\t\t\t\t} while (el);\n\n\t\t\t\t$window.css({\n\t\t\t\t\ttransform: `perspective(4000px) rotateY(${-(offsetLeft + (this.clientWidth - innerWidth) / 2) / innerWidth / 3\n\t\t\t\t\t\t}turn) rotateX(${(offsetTop + (this.clientHeight - innerHeight) / 2) / innerHeight / 3\n\t\t\t\t\t\t}turn)`,\n\t\t\t\t\ttransformOrigin: \"50% 50%\",\n\t\t\t\t\ttransformStyle: \"preserve-3d\",\n\t\t\t\t\t// FIXME: interactivity problems (with order elements are considered to have), I think introduced with preserve-3d\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t\tanimate();\n\t};\n\n\ttoggle3D = function () {\n\t\tif (cleanup) {\n\t\t\tdisable3D();\n\t\t} else {\n\t\t\tenable3D();\n\t\t}\n\t};\n\n\taddEventListener(\"keydown\", Konami.code(toggle3D));\n}());\n"]}